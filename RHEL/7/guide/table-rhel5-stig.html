<html xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cdf="http://checklists.nist.gov/xccdf/1.1" xmlns:xhtml="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Rules In Draft Red Hat Enterprise Linux 5 Security Technical Implementation Guide</title>
</head>
<body>
<br><br><div style="text-align: center; font-size: x-large; font-weight:bold">
			Rules In <i>Draft Red Hat Enterprise Linux 5 Security Technical Implementation Guide</i>
</div>
<br><br><style type="text/css">
		table
		{
			border-collapse:collapse;
		}
		table, th, td
		{
			border: 2px solid #dcdcdc;
			border-left: none;
			border-right: none;
			vertical-align: top;
			padding: 2px;
			font-family: verdana,arial,sans-serif;
			font-size:11px;
		}
		pre { 
			white-space: pre-wrap;
			white-space: -moz-pre-wrap !important;
			word-wrap:break-word; 
		}
		table tr:nth-child(2n+2) { background-color: #f4f4f4; }
		thead
		{
			display: table-header-group;
			font-weight: bold;
			background-color: #dedede;
		}
	</style>
<table>
<thead>
<td>V-ID</td>
<td>CCI</td>
<td>CAT</td>
<td>Title</td>
<td>Description</td>
<td>Check Procedures</td>
<td>Fixtext</td>
</thead>
<tr>
<td>V-756</td>
<td>CCE-4241-6</td>
<td>medium</td>
<td>The system must require authentication upon booting into single-user and maintenance modes.</td>
<td>If the system does not require valid root authentication before it boots into single-user or maintenance mode, anyone who invokes single-user or maintenance mode is granted privileged access to all files on the system.</td>
<td></td>
<td>Edit /etc/inittab and set sulogin to run in single-user mode.
Example line in /etc/inittab:
~:S:wait:/sbin/sulogin</td>
</tr>
<tr>
<td>V-763</td>
<td>CCI-000048</td>
<td>medium</td>
<td>The Department of Defense (DoD) login banner must be displayed immediately prior to, or as part of, console login prompts.</td>
<td>Failure to display the logon banner prior to a logon attempt will negate legal proceedings resulting from unauthorized access to system resources.</td>
<td></td>
<td>Edit /etc/issue and add one of the DoD login banners (based on the character limitations imposed by the system).

DoD Login Banners:

You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests- -not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details. 

OR

I've read &amp; consent to terms in IS user agreem't.</td>
</tr>
<tr>
<td>V-770</td>
<td>CCI-000366</td>
<td>high</td>
<td>The system must not have accounts configured with blank or null passwords.</td>
<td>If an account is configured for password authentication but does not have an assigned password, it may be possible to log into the account without authentication.  If the root user is configured without a password, the entire system may be compromised.  For user accounts not using password authentication, the account must be configured with a password lock value instead of a blank or null value.  </td>
<td></td>
<td>Edit /etc/pam.d/system-auth and remove the "nullok" setting.</td>
</tr>
<tr>
<td>V-773</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The root account must be the only account having a UID of 0.</td>
<td>If an account has a UID of 0, it has root authority.  Multiple accounts with a UID of 0 afford more opportunity for potential intruders to guess a password for a privileged account.
</td>
<td></td>
<td>Remove or change the UID of accounts other than root that have UID 0.</td>
</tr>
<tr>
<td>V-774</td>
<td>CCI-000366</td>
<td>low</td>
<td>The root user's home directory must not be the root directory (/).</td>
<td>Changing the root home directory to something other than / and assigning it a 0700 protection makes it more difficult for intruders to manipulate the system by reading the files root places in its default directory. It also gives root the same discretionary access control for root's home directory as for the other user home directories.</td>
<td></td>
<td>The root home directory should be something other than / (such as /roothome).

Procedure:
# mkdir /rootdir
# chown root /rootdir
# chgrp root /rootdir
# chmod 700 /rootdir
# cp -r /.??* /rootdir/.

Then, edit the passwd file and change the root home directory to /rootdir. The cp -r /.??* command copies all files and subdirectories of file names beginning with "." into the new root directory, which preserves the previous root environment. Ensure you are in the "/" directory when executing the "cp" command.</td>
</tr>
<tr>
<td>V-775</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The root account's home directory (other than /) must have mode 0700.</td>
<td>Permissions greater than 0700 could allow unauthorized users access to the root home directory.</td>
<td></td>
<td>The root home directory will have permissions of 0700. Do not change the protections of the / directory. Use the following command to change protections for the root home directory: 
# chmod 0700 /rootdir.</td>
</tr>
<tr>
<td>V-776</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The root account's executable search path must be the vendor default and must contain only absolute paths.</td>
<td>The executable search path (typically the PATH environment variable) contains a list of directories for the shell to search to find executables.  If this path includes the current working directory or other relative paths, executables in these directories may be executed instead of system commands.  This variable is formatted as a colon-separated list of directories.  If there is an empty entry, such as a leading or trailing colon or two consecutive colons, this is interpreted as the current working directory.  Entries starting with a slash (/) are absolute paths.
</td>
<td></td>
<td>Edit the root user's local initialization files ~/.profile,~/.bashrc (assuming root shell is bash). Change any found PATH variable settings to the vendor's default path for the root user. Remove any empty path entries or references to relative paths.</td>
</tr>
<tr>
<td>V-777</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The root account must not have world-writable directories in its executable search path.</td>
<td>If the root search path contains a world-writable directory, malicious software could be placed in the path by intruders and/or malicious users and inadvertently run by root with all of root's privileges.
</td>
<td></td>
<td>For each world-writable path in root's executable search path, do one of the following:

1. Remove the world-writable permission on the directory.
Procedure:
# chmod o-w &lt;path&gt;

2. Remove the world-writable directory from the executable search path.
Procedure:
Identify and edit the initialization file referencing the world-writable directory and remove it from the PATH variable.</td>
</tr>
<tr>
<td>V-781</td>
<td>CCI-000366</td>
<td>low</td>
<td>All GIDs referenced in the /etc/passwd file must be defined in the /etc/group file.</td>
<td>If a user is assigned the GID of a group not existing on the system, and a group with the GID is subsequently created, the user may have unintended rights to the group.
</td>
<td></td>
<td>Add a group to the system for each GID referenced without a corresponding group.</td>
</tr>
<tr>
<td>V-787</td>
<td>CCI-001314</td>
<td>medium</td>
<td>System log files must have mode 0640 or less permissive.</td>
<td>If the system log files are not protected, unauthorized users could change the logged data, eliminating its forensic value.</td>
<td></td>
<td>Change the mode of the system log file(s) to 0640 or less permissive.

Procedure:
# chmod 0640 /path/to/system-log-file

Note: Do not confuse system log files with audit logs.</td>
</tr>
<tr>
<td>V-788</td>
<td>CCI-000225</td>
<td>medium</td>
<td>All skeleton files (typically those in /etc/skel) must have mode 0644 or less permissive.</td>
<td>If the skeleton files are not protected, unauthorized personnel could change user startup parameters and possibly jeopardize user files.

</td>
<td></td>
<td>Change the mode of skeleton files with incorrect mode:
# chmod 0644 &lt;skeleton file&gt;</td>
</tr>
<tr>
<td>V-789</td>
<td>CCI-000225</td>
<td>medium</td>
<td>NIS/NIS+/yp files must be owned by root, sys, or bin.</td>
<td>NIS/NIS+/yp files are part of the system's identification and authentication processes and are critical to system security.  Failure to give ownership of sensitive files or utilities to root or bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture.</td>
<td></td>
<td>Change the ownership of NIS/NIS+/yp files to root, sys or bin. 

Procedure (example):
# chown root &lt;filename&gt;</td>
</tr>
<tr>
<td>V-791</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The NIS/NIS+/yp command files must have mode 0755 or less permissive.</td>
<td>NIS/NIS+/yp files are part of the system's identification and authentication processes and are critical to system security.  Unauthorized modification of these files could compromise these processes and the system.</td>
<td></td>
<td>Change the mode of NIS/NIS+/yp command files to 0755 or less permissive.

Procedure (example):
# chmod 0755 &lt;filename&gt;</td>
</tr>
<tr>
<td>V-793</td>
<td>CCI-001499</td>
<td>medium</td>
<td>Library files must have mode 0755 or less permissive.</td>
<td>Unauthorized access could destroy the integrity of the library files.</td>
<td></td>
<td>Change the mode of library files to 0755 or less permissive.

Procedure (example):
# chmod go-w &lt;/path/to/library-file&gt;

Note: Library files should have an extension of ".a" or a ".so" extension, possibly followed by a version number.</td>
</tr>
<tr>
<td>V-794</td>
<td>CCI-001499</td>
<td>medium</td>
<td>All system command files must have mode 0755 or less permissive.</td>
<td>Restricting permissions will protect system command files from unauthorized modification.  System command files include files present in directories used by the operating system for storing default system executables and files present in directories included in the system's default executable search paths.</td>
<td></td>
<td>Change the mode for system command files to 0755 or less permissive taking into account necessary GIUD and SUID bits.

Procedure:
# chmod go-w &lt;filename&gt;</td>
</tr>
<tr>
<td>V-795</td>
<td>CCI-001499</td>
<td>medium</td>
<td>All system files, programs, and directories must be owned by a system account.</td>
<td>Restricting permissions will protect the files from unauthorized modification.</td>
<td></td>
<td>Change the owner of system files, programs, and directories to a system account.

Procedure:
# chown root /some/system/file

(A different system user may be used in place of root.)</td>
</tr>
<tr>
<td>V-796</td>
<td>CCI-001499</td>
<td>medium</td>
<td>System files, programs, and directories must be group-owned by a system group.</td>
<td>Restricting permissions will protect the files from unauthorized modification.</td>
<td></td>
<td>Change the group-owner of system files to a system group.

Procedure:
# chgrp root /path/to/system/file

(System groups other than root may be used.)</td>
</tr>
<tr>
<td>V-797</td>
<td>CCE-3918-0</td>
<td>medium</td>
<td>The /etc/shadow (or equivalent) file must be owned by root.</td>
<td>The /etc/shadow file contains the list of local system accounts.  It is vital to system security and must be protected from unauthorized modification.  Failure to give ownership of sensitive files or utilities to root or bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture.</td>
<td></td>
<td>Change the ownership of the /etc/shadow (or equivalent) file.
# chown root /etc/shadow</td>
</tr>
<tr>
<td>V-798</td>
<td>CCE-3566-7</td>
<td>medium</td>
<td>The /etc/passwd file must have mode 0644 or less permissive.</td>
<td>If the passwd file is writable by a group-owner or the world, the risk of passwd file compromise is increased.  The passwd file contains the list of accounts on the system and associated information.</td>
<td></td>
<td>Change the mode of the passwd file to 0644.

Procedure:
# chmod 0644 /etc/passwd</td>
</tr>
<tr>
<td>V-800</td>
<td>CCE-4130-1</td>
<td>medium</td>
<td>The /etc/shadow (or equivalent) file must have mode 0400.</td>
<td>The /etc/shadow file contains the list of local system accounts.  It is vital to system security and must be protected from unauthorized modification.  The file also contains password hashes which must not be accessible to users other than root.</td>
<td></td>
<td>Change the mode of the /etc/shadow (or equivalent) file.
# chmod 0400 /etc/shadow</td>
</tr>
<tr>
<td>V-808</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The system and user default umask must be 077.</td>
<td>The umask controls the default access mode assigned to newly created files.  An umask of 077 limits new files to mode 700 or less permissive.  Although umask can be represented as a 4-digit number, the first digit representing special access modes is typically ignored or required to be 0.  This requirement applies to the globally configured system defaults and the user defaults for each account on the system.</td>
<td></td>
<td>Edit local and global initialization files that contain "umask" and change them to use 077 instead of the current value.</td>
</tr>
<tr>
<td>V-812</td>
<td>CCI-000162</td>
<td>medium</td>
<td>System audit logs must be owned by root.</td>
<td>Failure to give ownership of system audit log files to root provides the designated owner and unauthorized users with the potential to access sensitive information.</td>
<td></td>
<td>Change the ownership of the audit log file(s).

Procedure:
# chown root &lt;audit log file&gt;</td>
</tr>
<tr>
<td>V-813</td>
<td>CCI-000163</td>
<td>medium</td>
<td>System audit logs must have mode 0640 or less permissive.</td>
<td>If a user can write to the audit logs, audit trails can be modified or destroyed and system intrusion may not be detected.  System audit logs are those files generated from the audit system and do not include activity, error, or other log files created by application software.</td>
<td></td>
<td>Change the mode of the audit log directories/files.
# chmod 0750 &lt;audit directory&gt;
# chmod 0640 &lt;audit file&gt;</td>
</tr>
<tr>
<td>V-814</td>
<td>CCI-000126</td>
<td>medium</td>
<td>The audit system must be configured to audit failed attempts to access files and programs.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>Edit the audit.rules file and add the following line(s) to enable auditing of failed attempts to access files and programs:

either:
-a exit,always -F arch=&lt;ARCH&gt; -S creat -F success=0

or both:
-a exit,always -F arch=&lt;ARCH&gt; -S creat -F exit=-EPERM
-a exit,always -F arch=&lt;ARCH&gt; -S creat -F exit=-EACCES

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-815</td>
<td>CCI-000126</td>
<td>medium</td>
<td>The audit system must be configured to audit files and programs deleted by the user.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>Edit the audit.rules file and add the following line to enable auditing of deletions:
-a exit,always -S unlink

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-818</td>
<td>CCE-14904-7</td>
<td>medium</td>
<td>The audit system must be configured to audit login, logout, and session initiation.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>Ensure logins 

Procedure:
Modify /etc/audit/audit.rules to contain:

-w /var/log/faillog -p wa
-w /var/log/lastlog -p wa</td>
</tr>
<tr>
<td>V-819</td>
<td>CCE-14058-2</td>
<td>medium</td>
<td>The audit system must be configured to audit all discretionary access control permission modifications.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.
</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.

Procedure:
Edit the audit.rules file and add the following lines to enable auditing of discretionary access control permissions modifications.
-a exit,always -F arch=&lt;ARCH&gt; -S chmod

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-821</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The inetd.conf file, xinetd.conf file, and the xinetd.d directory must be owned by root or bin.</td>
<td>Failure to give ownership of sensitive files or utilities to root provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration possibly weakening the system's security posture.</td>
<td></td>
<td>Change the owner of the xinetd configuration files.
# chown root /etc/xinetd.conf /etc/xinetd.d/*</td>
</tr>
<tr>
<td>V-822</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The inetd.conf and xinetd.conf files must have mode 0440 or less permissive.</td>
<td>The Internet service daemon configuration files must be protected as malicious modification could cause Denial of Service or increase the attack surface of the system.</td>
<td></td>
<td>Change the mode of the xinetd configuration files.
# chmod 0640 /etc/xinetd.conf /etc/xinetd.d/*</td>
</tr>
<tr>
<td>V-823</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The services file must be owned by root or bin.</td>
<td>Failure to give ownership of sensitive files or utilities to root or bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration possibly weakening the system's security posture.</td>
<td></td>
<td>Change the ownership of the services file to root or bin.

Procedure:
# chown root /etc/services</td>
</tr>
<tr>
<td>V-824</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The services file must have mode 0644 or less permissive.</td>
<td>The services file is critical to the proper operation of network services and must be protected from unauthorized modification.  Unauthorized modification could result in the failure of network services.</td>
<td></td>
<td>Change the mode of the services file to 0644 or less permissive.

Procedure:
# chmod 0644 /etc/services</td>
</tr>
<tr>
<td>V-825</td>
<td>CCI-000366</td>
<td>low</td>
<td>Global initialization files must contain the "mesg -n" or "mesg n" commands.</td>
<td>If the "mesg -n" or "mesg n" command is not placed into the system profile, messaging can be used to cause a Denial of Service attack.</td>
<td></td>
<td>Edit /etc/profile or another global initialization script, and add the "mesg -n" command.</td>
</tr>
<tr>
<td>V-828</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The hosts.lpd (or equivalent) file must be owned by root, bin, sys, or lp.</td>
<td>Failure to give ownership of the hosts.lpd file to root, bin, sys, or lp provides the designated owner, and possible unauthorized users, with the potential to modify the hosts.lpd file.  Unauthorized modifications could disrupt access to local printers from authorized remote hosts or permit unauthorized remote access to local printers.</td>
<td></td>
<td>Change the owner of the /etc/cups/printers.conf to root. 

Procedure:
# chown root /etc/cups/printers.conf</td>
</tr>
<tr>
<td>V-829</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The hosts.lpd (or equivalent) must have mode 0644 or less permissive.</td>
<td>Excessive permissions on the hosts.lpd (or equivalent) file may permit unauthorized modification.  Unauthorized modifications could disrupt access to local printers from authorized remote hosts or permit unauthorized remote access to local printers.</td>
<td></td>
<td>Change the mode of the /etc/cups/printers.conf file to 0664 or less permissive.

Procedure:
# chmod 0664 /etc/cups/printers.conf</td>
</tr>
<tr>
<td>V-831</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The alias file must be owned by root.</td>
<td>If the alias file is not owned by root, an unauthorized user may modify the file adding aliases to run malicious code or redirect e-mail.</td>
<td></td>
<td>Change the owner of the /etc/aliases file to root.

Procedure:
for sendmail:
# chown root /etc/aliases
# chown root /etc/aliases.db

for postfix
# chown root /etc/postfix/aliases
# chown root /etc/postfix/aliases.db</td>
</tr>
<tr>
<td>V-832</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The alias file must have mode 0644 or less permissive.</td>
<td>Excessive permissions on the aliases file may permit unauthorized modification.  If the alias file is modified by an unauthorized user, they may modify the file to run malicious code or redirect e-mail.</td>
<td></td>
<td>Change the mode of the alias files as needed to function. No higher than 0644.
Procedure:
for sendmail:
# chmod 0644 /etc/aliases /etc/aliases.db

for postfix (assuming the default postfix directory):
# chmod 0644 /etc/postfix/aliases /etc/postfix/aliases.db</td>
</tr>
<tr>
<td>V-834</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Files executed through a mail aliases file must have mode 0755 or less permissive.</td>
<td>If a file executed through a mail aliases file has permissions greater than 0755, it can be modified by an unauthorized user and may contain malicious code or instructions potentially compromising the system.</td>
<td></td>
<td>Use the chmod command to change the access permissions for files executed from the alias file. 

For example:
# chmod 0755 filename</td>
</tr>
<tr>
<td>V-835</td>
<td>CCI-000366</td>
<td>low</td>
<td>Sendmail logging must not be set to less than nine in the sendmail.cf file.</td>
<td>If Sendmail is not configured to log at level 9, system logs may not contain the information necessary for tracking unauthorized use of the sendmail service.</td>
<td></td>
<td>Edit the sendmail.conf file, locate the "O L" or "LogLevel" entry and change it to 9.</td>
</tr>
<tr>
<td>V-837</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The SMTP service log file must be owned by root.</td>
<td>If the SMTP service log file is not owned by root, then unauthorized personnel may modify or delete the file to hide a system compromise.</td>
<td></td>
<td>Change the ownership of the sendmail log file.

Procedure:
The fix procedure is the same for both sendmail and Postfix.
# chown root &lt;sendmail log file&gt;</td>
</tr>
<tr>
<td>V-838</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The SMTP service log file must have mode 0644 or less permissive.</td>
<td>If the SMTP service log file is more permissive than 0644, unauthorized users may be allowed to change the log file.</td>
<td></td>
<td>Change the mode of the SMTP service log file.

Procedure:
The fix procedure is the same for both sendmail and Postfix.
# chmod 0644 &lt;sendmail log file&gt;</td>
</tr>
<tr>
<td>V-840</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The ftpusers file must exist.</td>
<td>The ftpusers file contains a list of accounts not allowed to use FTP to transfer files. If this file does not exist, then unauthorized accounts can utilize FTP.</td>
<td></td>
<td>Create an ftpusers file appropriate for the running FTP service.
For gssftp:
Create an /etc/ftpusers file containing a list of accounts not authorized for FTP.

For vsftp:
Create an /etc/vfsftpd.ftpusers or /etc/vfsftpd/ftpusers (as appropriate) file containing a list of accounts not authorized for FTP.</td>
</tr>
<tr>
<td>V-842</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The ftpusers file must be owned by root.</td>
<td>If the file ftpusers is not owned by root, an unauthorized user may modify the file to allow unauthorized accounts to use FTP.</td>
<td></td>
<td>Change the owner of the ftpusers file to root.
For gssftp:
# chown root /etc/ftpusers

For vsftp:
# chown root /etc/vsftpd.ftpusers /etc/vsftpd/ftpusers</td>
</tr>
<tr>
<td>V-843</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The ftpusers file must have mode 0640 or less permissive.</td>
<td>Excessive permissions on the ftpusers file could permit unauthorized modification. Unauthorized modification could result in Denial of Service to authorized FTP users or permit unauthorized users to access the FTP service.</td>
<td></td>
<td>Change the mode of the ftpusers file to 0640.

Procedure:
For gssftp:
# chmod 0640 /etc/ftpusers

For vsftp:
# chmod 0640 /etc/vsftpd.ftpusers /etc/vsftpd/ftpusers</td>
</tr>
<tr>
<td>V-847</td>
<td>CCI-000366</td>
<td>high</td>
<td>The TFTP daemon must operate in "secure mode" which provides access only to a single directory on the host file system.</td>
<td>Secure mode limits TFTP requests to a specific directory.  If TFTP is not running in secure mode, it may be able to write to any file or directory and may seriously impair system integrity, confidentiality, and availability.</td>
<td></td>
<td>Edit /etc/xinetd.d/tftp file and specify the "-s" parameter in server_args.</td>
</tr>
<tr>
<td>V-848</td>
<td>CCI-000225</td>
<td>high</td>
<td>The TFTP daemon must have mode 0755 or less permissive.</td>
<td>If TFTP runs with the setuid or setgid bit set, it may be able to write to any file or directory and may seriously impair system integrity, confidentiality, and availability.</td>
<td></td>
<td>Change the mode of the TFTP daemon.

Procedure:
# chmod 0755 &lt;in.tftpd binary&gt;</td>
</tr>
<tr>
<td>V-867</td>
<td>CCI-001435</td>
<td>medium</td>
<td>The Network Information System (NIS) protocol must not be used.</td>
<td>Due to numerous security vulnerabilities existing within NIS, it must not be used.  Possible alternative directory services are NIS+ and LDAP.</td>
<td></td>
<td>Disable the use of NIS/NIS+. Use as a replacement Kerberos or LDAP.</td>
</tr>
<tr>
<td>V-899</td>
<td>CCI-000225</td>
<td>low</td>
<td>All interactive users must be assigned a home directory in the /etc/passwd file.</td>
<td>If users do not have a valid home directory, there is no place for the storage and control of files they own.</td>
<td></td>
<td>Assign a home directory to any user without one.</td>
</tr>
<tr>
<td>V-900</td>
<td>CCI-000225</td>
<td>low</td>
<td>All interactive user home directories defined in the /etc/passwd file must exist.</td>
<td>If a user has a home directory defined that does not exist, the user may be given the / directory, by default, as the current working directory upon logon.  This could create a Denial of Service because the user would not be able to perform useful tasks in this location.</td>
<td></td>
<td>If a user has no home directory, determine why. If possible, delete accounts without a home directory. If the account is valid, then create the home directory using the appropriate system administration utility or manually.
For instance: mkdir directoryname; copy the skeleton files into the directory; chown accountname for the new directory and the skeleton files. Document all changes.</td>
</tr>
<tr>
<td>V-901</td>
<td>CCE-4090-7</td>
<td>medium</td>
<td>All user home directories must have mode 0750 or less permissive.</td>
<td>Excessive permissions on home directories allow unauthorized access to user files.</td>
<td></td>
<td>Change the mode of user home directories to 0750 or less permissive.

Procedure (example):
# chmod 0750 &lt;home directory&gt;

Note: Application directories are allowed and may need 0755 permissions (or greater) for correct operation.</td>
</tr>
<tr>
<td>V-906</td>
<td>CCI-000225</td>
<td>medium</td>
<td>All run control scripts must have mode 0755 or less permissive.</td>
<td>If the startup files are writable by other users, they could modify the startup files to insert malicious commands into the startup files.</td>
<td></td>
<td>Ensure all system startup files have mode 0755 or less permissive. Examine the "rc" files, and all files in the rc1.d (rc2.d, and so on) directories, and in the /etc/init.d directory to ensure they are not world-writable. If they are world-writable, use the chmod command to correct the vulnerability and research why they are world-writable.

Procedure: 
# chmod 755 &lt;startup file&gt;</td>
</tr>
<tr>
<td>V-913</td>
<td>CCI-000196</td>
<td>medium</td>
<td>There must be no .netrc files on the system.</td>
<td>Unencrypted passwords for remote FTP servers may be stored in .netrc files. Policy requires passwords be encrypted in storage and not used in access scripts.</td>
<td></td>
<td>Remove the .netrc file(s).

Procedure:
# find / -name .netrc
# rm &lt;.netrc file&gt;</td>
</tr>
<tr>
<td>V-916</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The /etc/shells (or equivalent) file must exist.</td>
<td>The shells file (or equivalent) lists approved default shells. It helps provide layered defense to the security approach by ensuring users cannot change their default shell to an unauthorized unsecure shell.</td>
<td></td>
<td>Create a /etc/shells file containing a list of valid system shells. Consult vendor documentation for an appropriate list of system shells.

Procedure:
# echo "/bin/bash" &gt;&gt; /etc/shells
# echo "/bin/csh" &gt;&gt; /etc/shells
(Repeat as necessary for other shells.)</td>
</tr>
<tr>
<td>V-921</td>
<td>CCI-000225</td>
<td>medium</td>
<td>All shell files must be owned by root or bin.</td>
<td>If shell files are owned by users other than root or bin, they could be modified by intruders or malicious users to perform unauthorized actions.</td>
<td></td>
<td>Change the ownership of the shell with incorrect ownership.
# chown root &lt;shell&gt;</td>
</tr>
<tr>
<td>V-922</td>
<td>CCI-000225</td>
<td>high</td>
<td>All shell files must have mode 0755 or less permissive.</td>
<td>Shells with world/group write permissions give the ability to maliciously modify the shell to obtain unauthorized access.</td>
<td></td>
<td>Change the mode of the shell.
# chmod 0755 &lt;shell&gt;</td>
</tr>
<tr>
<td>V-924</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Device files and directories must only be writable by users with a system account or as configured by the vendor.</td>
<td>System device files in writable directories could be modified, removed, or used by an unprivileged user to control system hardware.</td>
<td></td>
<td>Remove the world-writable permission from the device file(s).

Procedure:
# chmod o-w &lt;device file&gt;

Document all changes.</td>
</tr>
<tr>
<td>V-928</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The Network File System (NFS) export configuration file must be owned by root.</td>
<td>Failure to give ownership of the NFS export configuration file to root provides the designated owner and possible unauthorized users with the potential to change system configuration which could weaken the system's security posture.</td>
<td></td>
<td>Change the owner of the exports file to root.

Example:
# chown root /etc/exports</td>
</tr>
<tr>
<td>V-929</td>
<td>CCI-000225</td>
<td>low</td>
<td>The Network File System (NFS) export configuration file must have mode 0644 or less permissive.</td>
<td>Excessive permissions on the NFS export configuration file could allow unauthorized modification of the file, which could result in Denial of Service to authorized NFS exports and the creation of additional unauthorized exports.</td>
<td></td>
<td># chmod 0644 /etc/exports</td>
</tr>
<tr>
<td>V-931</td>
<td>CCI-000225</td>
<td>medium</td>
<td>All Network File System (NFS) exported system files and system directories must be owned by root.</td>
<td>Failure to give ownership of sensitive files or directories  to root provides the designated owner and possible unauthorized users with the potential to access sensitive information or change system configuration which could weaken the system's security posture.</td>
<td></td>
<td>Change the ownership of exported file systems not owned by root.

Procedure:
# chown root &lt;path&gt;</td>
</tr>
<tr>
<td>V-932</td>
<td>CCI-000062</td>
<td>medium</td>
<td>The Network File System (NFS) anonymous UID and GID must be configured to values without permissions.</td>
<td>When an NFS server is configured to deny remote root access, a selected UID and GID are used to handle requests from the remote root user.  The UID and GID should be chosen from the system to provide the appropriate level of non-privileged access.</td>
<td></td>
<td>Edit "/etc/exports" and set the "anonuid=-1" and "anongid=-1" options for exports lacking it. Re-export the filesystems.</td>
</tr>
<tr>
<td>V-933</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The Network File System (NFS) server must be configured to restrict file system access to local hosts.</td>
<td>The NFS access option limits user access to the specified level. This assists in protecting exported file systems.  If access is not restricted, unauthorized hosts may be able to access the system's NFS exports.</td>
<td></td>
<td>Edit /etc/exports and add ro and/or rw options (as appropriate) specifying a list of hosts or networks which are permitted access. Re-export the file systems.</td>
</tr>
<tr>
<td>V-935</td>
<td>CCE-4544-3</td>
<td>medium</td>
<td>The Network File System (NFS) server must not allow remote root access.</td>
<td>If the NFS server allows root access to local file systems from remote hosts, this access could be used to compromise the system.</td>
<td></td>
<td>Edit the "/etc/exports" file and add "root_squash" (or "all_squash") and remove "no_root_squash".</td>
</tr>
<tr>
<td>V-936</td>
<td>CCE-4024-6</td>
<td>medium</td>
<td>The "nosuid" option must be enabled on all Network File System (NFS) client mounts.</td>
<td>Enabling the nosuid mount option prevents the system from granting owner or group-owner privileges to programs with the suid or sgid bit set.  If the system does not restrict this access, users with unprivileged access to the local system may be able to acquire privileged access by executing suid or sgid files located on the mounted NFS file system.</td>
<td></td>
<td>Edit "/etc/fstab" and add the "nosuid" option for all NFS file systems. Remount the NFS file systems to make the change take effect.</td>
</tr>
<tr>
<td>V-940</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The system must use an access control program.</td>
<td>Access control programs (such as TCP_WRAPPERS) provide the ability to enhance system security posture.</td>
<td></td>
<td>Install and configure the tcp_wrappers package.</td>
</tr>
<tr>
<td>V-941</td>
<td>CCI-000126</td>
<td>medium</td>
<td>The system's access control program must log each system access attempt.</td>
<td>If access attempts are not logged, then multiple attempts to log on to the system by an unauthorized user may go undetected.</td>
<td></td>
<td>Configure the access restriction program to log every access attempt. Ensure the implementation instructions for tcp_wrappers are followed so system access attempts are recorded to the system log files. If an alternate application is used, it must support this function.</td>
</tr>
<tr>
<td>V-974</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Access to the cron utility must be controlled using the cron.allow and/or cron.deny file(s).</td>
<td>The cron facility allows users to execute recurring jobs on a regular and unattended basis.  The cron.allow file designates accounts allowed to enter and execute jobs using the cron facility.  If neither cron.allow nor cron.deny exists, then any account may use the cron facility.  This may open the facility up for abuse by system intruders and malicious users.</td>
<td></td>
<td>Create /etc/cron.allow and/or /etc/cron.deny with appropriate content.</td>
</tr>
<tr>
<td>V-975</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The cron.allow file must have mode 0600 or less permissive.</td>
<td>A readable and/or writable cron.allow file by users other than root could allow potential intruders and malicious users to use the file contents to help discern information, such as who is allowed to execute cron programs, which could be harmful to overall system and network security.</td>
<td></td>
<td>Change the mode of the cron.allow file to 0600.

Procedure:
# chmod 0600 /etc/cron.allow</td>
</tr>
<tr>
<td>V-978</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Crontab files must have mode 0600 or less permissive, and files in cron script directories must have mode 0700 or less permissive.</td>
<td>To protect the integrity of scheduled system jobs and prevent malicious modification to these jobs, crontab files must be secured.</td>
<td></td>
<td>Change the mode of the crontab files.
# chmod 0600 /var/spool/cron/* /etc/cron.d/* /etc/crontab</td>
</tr>
<tr>
<td>V-979</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Cron and crontab directories must have mode 0755 or less permissive.</td>
<td>To protect the integrity of scheduled system jobs and to prevent malicious modification to these jobs, crontab files must be secured.</td>
<td></td>
<td>Change the mode of the crontab directories.
# chmod 0755 &lt;crontab directory&gt;</td>
</tr>
<tr>
<td>V-980</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Cron and crontab directories must be owned by root or bin.</td>
<td>Incorrect ownership of the cron or crontab directories could permit unauthorized users the ability to alter cron jobs and run automated jobs as privileged users.  Failure to give ownership of cron or crontab directories to root or to bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture.</td>
<td></td>
<td>Change the mode of the crontab directories.
# chown root &lt;crontab directory&gt;</td>
</tr>
<tr>
<td>V-981</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Cron and crontab directories must be group-owned by root, sys, bin or cron.</td>
<td>To protect the integrity of scheduled system jobs and to prevent malicious modification to these jobs, crontab files must be secured.  Failure to give group-ownership of cron or crontab directories to a system group provides the designated group and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture.</td>
<td></td>
<td>Change the group owner of cron and crontab directories.
# chgrp root &lt;crontab directory&gt;</td>
</tr>
<tr>
<td>V-982</td>
<td>CCI-000126</td>
<td>medium</td>
<td>Cron logging must be implemented.</td>
<td>Cron logging can be used to trace the successful or unsuccessful execution of cron jobs.  It can also be used to spot intrusions into the use of the cron facility by unauthorized and malicious users.
</td>
<td></td>
<td>Edit /etc/syslog.conf and setup cron logging.</td>
</tr>
<tr>
<td>V-983</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The cronlog file must have mode 0600 or less permissive.</td>
<td>Cron logs contain reports of scheduled system activities and must be protected from unauthorized access or manipulation.
</td>
<td></td>
<td>Change the mode of the cron log file.
# chmod 0600 /var/log/cron</td>
</tr>
<tr>
<td>V-984</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Access to the "at" utility must be controlled via the at.allow and/or at.deny file(s).</td>
<td>The "at" facility selectively allows users to execute jobs at deferred times.  It is usually used for one-time jobs. The at.allow file selectively allows access to the "at" facility.  If there is no at.allow file, there is no ready documentation of who is allowed to submit "at" jobs.</td>
<td></td>
<td>Create at.allow and/or at.deny files containing appropriate lists of users to be allowed or denied access to the "at" daemon.</td>
</tr>
<tr>
<td>V-985</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The at.deny file must not be empty if it exists.</td>
<td>On some systems, if there is no at.allow file and there is an empty at.deny file, then the system assumes everyone has permission to use the "at" facility.  This could create an insecure setting in the case of malicious users or system intruders.</td>
<td></td>
<td>Add appropriate users to the at.deny file, or remove the empty at.deny file if an at.allow file exists.</td>
</tr>
<tr>
<td>V-986</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Default system accounts (with the exception of root) must not be listed in the at.allow file or must be included in the at.deny file if the at.allow file does not exist.</td>
<td>Default accounts, such as bin, sys, adm, uucp, daemon, and others, should never have access to the "at" facility.  This would create a possible vulnerability open to intruders or malicious users.</td>
<td></td>
<td>Remove the default accounts (such as bin, sys, adm, and others, traditionally UID less than 500) from the at.allow file.</td>
</tr>
<tr>
<td>V-987</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The at.allow file must have mode 0600 or less permissive.</td>
<td>Permissions more permissive than 0600 (read, write and execute for the owner) may allow unauthorized or malicious access to the at.allow and/or at.deny files.</td>
<td></td>
<td>Change the mode of the at.allow file.
# chmod 0600 /etc/at.allow</td>
</tr>
<tr>
<td>V-994</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The snmpd.conf file must have mode 0600 or less permissive.</td>
<td>The snmpd.conf file contains authenticators and must be protected from unauthorized access and modification.</td>
<td></td>
<td>Change the mode of the SNMP daemon configuration file to 0600. 

Procedure:
# chmod 0600 &lt;snmpd.conf&gt;</td>
</tr>
<tr>
<td>V-995</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Management Information Base (MIB) files must have mode 0640 or less permissive.</td>
<td>The ability to read the MIB file could impart special knowledge to an intruder or malicious user about the ability to extract compromising information about the system or network.</td>
<td></td>
<td>Change the mode of MIB files to 0640.

Procedure:
# chmod 0640 &lt;mib file&gt;</td>
</tr>
<tr>
<td>V-1011</td>
<td>CCI-000134</td>
<td>low</td>
<td>Inetd or xinetd logging/tracing must be enabled.</td>
<td>Inetd or xinetd logging and tracing allows the system administrators to observe the IP addresses connecting to their machines and what network services are being sought.  This provides valuable information when trying to find the source of malicious users and potential malicious users.</td>
<td></td>
<td>Edit each file in the /etc/xinetd.d directory and the /etc/xinetd.conf file to contain:
log_type = SYSLOG authpriv
log_on_success = HOST PID USERID EXIT
log_on_failure = HOST USERID

The /etc/xinetd.conf file contains default values that will hold true for all services unless individually modified in the service's xinetd.d file.

To make the new settings effective, restart the xinetd service:
# service xinetd restart</td>
</tr>
<tr>
<td>V-1021</td>
<td>CCI-000032</td>
<td>medium</td>
<td>The X server must have the correct options enabled.</td>
<td>Without the correct options enabled, the Xwindows system would be less secure and there would be no screen timeout.</td>
<td></td>
<td>Enable the following options: -audit (at level 4), -auth and -s with 15 minutes as the timeout value.

Procedure for gdm:
Edit /etc/gdm/custom.conf and add the following:
[server-Standard] 
name=Standard server
command=/usr/bin/Xorg -br -audit 4 -s 15
chooser=false
handled=true
flexible=true
priority=0

Procedure for xinit:
Edit or create a .xserverrc file in the users home directory containing the startup script for xinit.
This script must have an exec line with at least these options:

exec /usr/bin/X -audit 4 -s 15 -auth &lt;Xauth file&gt; &amp;

The &lt;Xauth file&gt; is created using the "xauth" command and is customarily located in the users home directory with the name ".Xauthority".</td>
</tr>
<tr>
<td>V-1022</td>
<td>CCI-000032</td>
<td>medium</td>
<td>An X server must have none of the following options enabled: -ac, -core (except for debugging purposes), or -nolock.</td>
<td>These options will detract from the security of the Xwindows system.</td>
<td></td>
<td>Disable the unwanted options: 
Procedure:
For gdm:
Remove the -ac, -core and -nolock options by creating a "command" entry in the /etc/gdm/custom.conf file with the options removed.

For Xwindows started by xinit:
Create or modify the .xserverrc script in the users home directory to remove the -ac, -core and -nolock options from the exec /usr/bin/X command.</td>
</tr>
<tr>
<td>V-1023</td>
<td>CCI-000381</td>
<td>medium</td>
<td>The system must not run an Internet Network News (INN) server.</td>
<td>INN servers access Usenet newsfeeds and store newsgroup articles.  INN servers use the Network News Transfer Protocol (NNTP) to transfer information from the Usenet to the server and from the server to authorized remote hosts.

If this function is necessary to support a valid mission requirement, its use must be authorized and approved in the system accreditation package.</td>
<td></td>
<td>Disable the INN server.</td>
</tr>
<tr>
<td>V-1025</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/access.conf file must be owned by root.</td>
<td>The /etc/access.conf file contains entries restricting access from the system console by authorized System Administrators.  If the file is owned by a user other than root, it could compromise the system.</td>
<td></td>
<td>Follow the correct configuration parameters for access configuration file. Use the chown command to configure it properly. 
(for example:
# chown root /etc/security/access.conf  
 ).</td>
</tr>
<tr>
<td>V-1027</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/smb.conf file must be owned by root.</td>
<td>The /etc/smb.conf file allows access to other machines on the network and grants permissions to certain users.  If it is owned by another user, the file may be maliciously modified and the Samba configuration could be compromised.</td>
<td></td>
<td>Change the ownership of the smb.conf file. 

Procedure:
# chown root smb.conf</td>
</tr>
<tr>
<td>V-1028</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/smb.conf file must have mode 0644 or less permissive.</td>
<td>If the "smb.conf" file has excessive permissions, the file may be maliciously modified and the Samba configuration could be compromised.</td>
<td></td>
<td>Change the mode of the smb.conf file to 0644 or less permissive.

Procedure:
# chmod 0644 smb.conf.</td>
</tr>
<tr>
<td>V-1029</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/smbpasswd file must be owned by root.</td>
<td>If the "smbpasswd" file is not owned by root, it may be maliciously accessed or modified, potentially resulting in the compromise of Samba accounts.</td>
<td></td>
<td>Use the chown command to configure the files maintained by smbpasswd.
For instance:
# chown root /etc/samba/passdb.tdb /etc/samba/secrets.tdb</td>
</tr>
<tr>
<td>V-1032</td>
<td>CCE-4180-6</td>
<td>medium</td>
<td>Users must not be able to change passwords more than once every 24 hours.</td>
<td>The ability to change passwords frequently facilitates users reusing the same password. This can result in users effectively never changing their passwords.  This would be accomplished by users changing their passwords when required and then immediately changing it to the original value.
</td>
<td></td>
<td>Change the minimum time period between password changes for each user account to 1 day.
# passwd -n 1 &lt;user name&gt;</td>
</tr>
<tr>
<td>V-1047</td>
<td>CCE-4387-7</td>
<td>medium</td>
<td>The system must not permit root logins using remote access programs such as ssh.</td>
<td>Even though communications are encrypted, an additional layer of security may be gained by extending the policy of not logging directly on as root.  In addition, logging in with a user-specific account preserves the audit trail.</td>
<td></td>
<td>Edit the sshd_config file and set the PermitRootLogin option to "no".</td>
</tr>
<tr>
<td>V-1048</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Audio devices must have mode 0660 or less permissive.</td>
<td>Audio and video devices that are globally accessible have proven to be another security hazard.  There is software that can activate system microphones and video devices connected to user workstations and/or X terminals.  Once the microphone has been activated, it is possible to eavesdrop on otherwise private conversations without the victim being aware of it.  This action effectively changes the user's microphone into a bugging device.</td>
<td></td>
<td>Change the mode of audio devices.
# chmod 0660 &lt;audio device&gt;</td>
</tr>
<tr>
<td>V-1049</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Audio devices must be owned by root.</td>
<td>Audio and video devices globally accessible have proven to be another security hazard. There is software that can activate system microphones and video devices connected to user workstations and/or X terminals. Once the microphone has been activated, it is possible to eavesdrop on otherwise private conversations without the victim being aware of it. This action effectively changes the user's microphone into a bugging device.</td>
<td></td>
<td>Change the owner of the audio device.
# chown root &lt;audio device&gt;</td>
</tr>
<tr>
<td>V-1054</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/access.conf file must have a privileged group owner.</td>
<td>Depending on the access restrictions of the /etc/access.conf file, if the group owner were not a privileged group, it could endanger system security.</td>
<td></td>
<td>Use the chgrp command to ensure the group owner is root, sys, or bin.
(for example:
# chgrp root /etc/security/access.conf

).</td>
</tr>
<tr>
<td>V-1055</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/access.conf file must have mode 0640 or less permissive.</td>
<td>If the access permissions are more permissive than 0640, system security could be compromised.</td>
<td></td>
<td>Use the chmod command to set the permissions to 0640.
(for example:
# chmod 0640 /etc/security/access.conf

).</td>
</tr>
<tr>
<td>V-1056</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/smb.conf file must be group-owned by root, bin, sys, or system.</td>
<td>If the group owner of the "smb.conf" file is not root or a system group, the file may be maliciously modified and the Samba configuration could be compromised.</td>
<td></td>
<td>Change the group owner of the smb.conf file.

Procedure:
# chgrp root smb.conf</td>
</tr>
<tr>
<td>V-1058</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The smbpasswd file must be group-owned by root.</td>
<td>If the smbpasswd file is not group-owned by root, the smbpasswd file may be maliciously accessed or modified, potentially resulting in the compromise of Samba accounts.</td>
<td></td>
<td>Use the chgrp command to ensure that the group owner of the smbpasswd file is root.
 
For instance:

# chgrp root /etc/samba/passdb.tdb /etc/samba/secrets.tdb</td>
</tr>
<tr>
<td>V-1059</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The smbpasswd file must have mode 0600 or less permissive.</td>
<td>If the smbpasswd file has a mode more permissive than 0600, the smbpasswd file may be maliciously accessed or modified, potentially resulting in the compromise of Samba accounts.</td>
<td></td>
<td>Change the mode of the files maintained through smbpasswd to 0600.

Procedure:
# chmod 0600 /etc/samba/passdb.tdb /etc/samba/secrets.tdb</td>
</tr>
<tr>
<td>V-1061</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Audio devices must be group-owned by root, sys, bin, or system.</td>
<td>Without privileged group owners, audio devices will be vulnerable to being used as eaves-dropping devices by malicious users or intruders to possibly listen to conversations containing sensitive information.</td>
<td></td>
<td>Change the group-owner of the audio device.

Procedure:
# chgrp root &lt;audio device&gt;</td>
</tr>
<tr>
<td>V-1062</td>
<td>CCI-000366</td>
<td>low</td>
<td>The root shell must be located in the / file system.</td>
<td>To ensure the root shell is available in repair and administrative modes, the root shell must be located in the / file system.</td>
<td></td>
<td>Change the root account's shell to one present on the / file system. 

Procedure:
Edit /etc/passwd and change the shell for the root account to one present on the / file system (such as /bin/sh, assuming /bin is not on a separate file system). If the system does not store shell configuration in the /etc/passwd file, consult vendor documentation for the correct procedure for the system.</td>
</tr>
<tr>
<td>V-4083</td>
<td>CCE-3315-9</td>
<td>medium</td>
<td>Graphical desktop environments provided by the system must automatically lock after 15 minutes of inactivity and the system must require users to re-authenticate to unlock the environment.

Applications requiring continuous, real-time screen display (i.e., network management products) require the following and need to be documented with the IAO.

-The logon session does not have administrator rights. 
-The display station (i.e., keyboard, monitor, etc.) is located in a controlled access area.</td>
<td>If graphical desktop sessions do not lock the session after 15 minutes of inactivity, requiring re-authentication to resume operations, the system or individual data could be compromised by an alert intruder who could exploit the oversight.  This requirement applies to graphical desktop environments provided by the system to locally attached displays and input devices as well as to graphical desktop environments provided to remote systems, including thin clients.</td>
<td></td>
<td>For the Gnome screen saver, set the idle_activation_enabled flag.
Procedure:
# gconftool-2 --direct --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory --type bool --set /apps/gnome-screensaver/idle_activation_enabled true</td>
</tr>
<tr>
<td>V-4084</td>
<td>CCE-14939-3</td>
<td>medium</td>
<td>The system must prohibit the reuse of passwords within five iterations.</td>
<td>If a user, or root, used the same password continuously or was allowed to change it back shortly after being forced to change it to something else, it would provide a potential intruder with the opportunity to keep guessing at one user's password until it was guessed correctly.</td>
<td></td>
<td>Create the password history file.
# touch /etc/security/opasswd
# chown root:root /etc/security/opasswd
# chmod 0600 /etc/security/opasswd

Enable password history.
If /etc/pam.d/system-auth references /etc/pam.d/system-auth-ac refer to the man page for system-auth-ac for a description of how to add options not configurable with authconfig. Edit /etc/pam.d/system-auth to include the remember option on the "password pam_unix" lines set to at least 5.</td>
</tr>
<tr>
<td>V-4089</td>
<td>CCI-000225</td>
<td>medium</td>
<td>All system start-up files must be owned by root.</td>
<td>System start-up files not owned by root could lead to system compromise by allowing malicious users or applications to modify them for unauthorized purposes.  This could lead to system and network compromise.</td>
<td></td>
<td>Change the ownership of the run control script(s) with incorrect ownership.
# find /etc -name "[SK][0-9]*"|xargs stat -L -c %U:%n|egrep -v "^root:"|cut -d: -f2|xargs chown root</td>
</tr>
<tr>
<td>V-4090</td>
<td>CCI-000225</td>
<td>medium</td>
<td>All system start-up files must be group-owned by root, sys, bin, other, or system.</td>
<td>If system start-up files do not have a group owner of root or a system group, the files may be modified by malicious users or intruders.</td>
<td></td>
<td>Change the group ownership of the run control script(s) with incorrect group ownership.

Procedure:
# chgrp root &lt;run control script&gt;
# find /etc -name "[SK][0-9]*"|xargs stat -L -c %G:%n|egrep -v "^(root|sys|bin|other):"|cut -d: -f2|xargs chgrp root</td>
</tr>
<tr>
<td>V-4248</td>
<td>CCI-000366</td>
<td>high</td>
<td>For systems capable of using GRUB, the system must be configured with GRUB as the default boot loader unless another boot loader has been authorized, justified, and documented using site-defined procedures.</td>
<td>GRUB is a versatile boot loader used by several platforms that can provide authentication for access to the system or boot loader.</td>
<td></td>
<td>Configure the system to use the GRUB bootloader or document, justify, and authorize the alternate bootloader.</td>
</tr>
<tr>
<td>V-4249</td>
<td>CCE-3818-2</td>
<td>high</td>
<td>The system boot loader must require authentication.</td>
<td>If the system's boot loader does not require authentication, users with console access to the system may be able to alter the system boot configuration or boot the system into single user or maintenance mode, which could result in Denial of Service or unauthorized privileged access to the system.</td>
<td></td>
<td>The GRUB console boot loader can be configured to use an MD5 encrypted password by adding password --md5 password-hash to the "/boot/grub/grub.conf" file. Use "/sbin/grub-md5-crypt" to generate MD5 passwords from the command line.</td>
</tr>
<tr>
<td>V-4250</td>
<td>CCE-3923-0</td>
<td>medium</td>
<td>The system's boot loader configuration file(s) must have mode 0600 or less permissive.</td>
<td>File permissions greater than 0600 on boot loader configuration files could allow an unauthorized user to view or modify sensitive information pertaining to system boot instructions.</td>
<td></td>
<td>Change the mode of the grub.conf file to 0600.

# chmod 0600 /boot/grub/grub.conf</td>
</tr>
<tr>
<td>V-4268</td>
<td>CCI-000225</td>
<td>high</td>
<td>The system must not have special privilege accounts, such as shutdown and halt.</td>
<td>If special privilege accounts are compromised, the accounts could provide privileges to execute malicious commands on a system.</td>
<td></td>
<td>Remove any special privilege accounts, such as shutdown and halt, from the /etc/passwd and /etc/shadow files using the "userdel" or "system-config-users" commands.</td>
</tr>
<tr>
<td>V-4275</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/news/readers.conf (or equivalent) must have mode 0600 or less permissive.</td>
<td>Excessive permissions on the readers.conf file may allow unauthorized modification which could lead to Denial of Service to authorized users or provide access to unauthorized users.</td>
<td></td>
<td>Change the mode of the /etc/news/readers.conf file to 0600.
# chmod 0600 /etc/news/readers.conf</td>
</tr>
<tr>
<td>V-4276</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/news/passwd.nntp file (or equivalent) must have mode 0600 or less permissive.</td>
<td>File permissions more permissive than 0600 for "/etc/news/passwd.nntp" may allow access to privileged information by system intruders or malicious users.</td>
<td></td>
<td>Change the mode of the "/etc/news/passwd.nntp" file.
# chmod 0600 /etc/news/passwd.nntp</td>
</tr>
<tr>
<td>V-4278</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The files in /etc/news must be group-owned by root or news.</td>
<td>If critical system files do not have a privileged group-owner, system integrity could be compromised.</td>
<td></td>
<td>Change the group-owner of the files in "/etc/news" to root or news.

Procedure:
# chgrp root /etc/news/*</td>
</tr>
<tr>
<td>V-4295</td>
<td>CCE-4325-7</td>
<td>high</td>
<td>The SSH daemon must be configured to only use the SSHv2 protocol.</td>
<td>SSHv1 is not a DoD-approved protocol and has many well-known vulnerability exploits.  Exploits of the SSH daemon could provide immediate root access to the system.</td>
<td></td>
<td>Edit the sshd_config file and set the "Protocol" setting to "2". If using the F-Secure SSH server, set the "Ssh1Compatibility" setting to "no".</td>
</tr>
<tr>
<td>V-4321</td>
<td>CCI-001436</td>
<td>medium</td>
<td>The system must not run Samba unless needed.</td>
<td>Samba is a tool used for the sharing of files and printers between Windows and UNIX operating systems.  It provides access to sensitive files and, therefore, poses a security risk if compromised.</td>
<td></td>
<td>If there is no functional need for Samba and the daemon is running, disable the daemon by killing the process ID as noted from the output of ps -ef |grep smbd. The samba package should also be removed or not installed if there is no functional requirement.

Procedure:
rpm -qa |grep samba

This will show whether "samba" or "samba3x" is installed. To remove:

rpm --erase samba
or
rpm --erase samba3x</td>
</tr>
<tr>
<td>V-4334</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/sysctl.conf file must be owned by root.</td>
<td>The sysctl.conf file specifies the values for kernel parameters to be set on boot.  These settings can affect the system's security.</td>
<td></td>
<td>Use the chown command to change the owner of /etc/sysctl.conf to root:
# chown root /etc/sysctl.conf</td>
</tr>
<tr>
<td>V-4335</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/sysctl.conf file must be group-owned by root.</td>
<td>The sysctl.conf file specifies the values for kernel parameters to be set on boot.  These settings can affect the system's security.</td>
<td></td>
<td>Use the chgrp command to change the group owner of /etc/sysctl.conf to root:
# chgrp root /etc/sysctl.conf</td>
</tr>
<tr>
<td>V-4336</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/sysctl.conf file must have mode 0600 or less permissive.</td>
<td>The sysctl.conf file specifies the values for kernel parameters to be set on boot.  These settings can affect the system's security.</td>
<td></td>
<td>Use the chmod command to change the mode of the /etc/sysctl.conf file.
# chmod 0600 /etc/sysctl.conf</td>
</tr>
<tr>
<td>V-4342</td>
<td>CCI-000366</td>
<td>high</td>
<td>The x86 CTRL-ALT-DELETE key sequence must be disabled.</td>
<td>Undesirable reboots can occur if the CTRL-ALT-DELETE key sequence is not disabled.  Such reboots may cause a loss of data or loss of access to critical information.</td>
<td></td>
<td>Ensure the CTRL-ALT-DELETE key sequence has been disabled and attempts to use the sequence are logged.
In the /etc/inittab file replace:
ca::ctrlaltdel:/sbin/shutdown -t3 -r now
with
ca:nil:ctrlaltdel:/usr/bin/logger -p security.info "Ctrl-Alt-Del was pressed"</td>
</tr>
<tr>
<td>V-4358</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The cron.deny file must have mode 0600 or less permissive.</td>
<td>If file permissions for cron.deny are more permissive than 0600, sensitive information could be viewed or edited by unauthorized users.
</td>
<td></td>
<td>Change the mode of the cron.deny file.
# chmod 0600 /etc/cron.deny</td>
</tr>
<tr>
<td>V-4361</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The cron.allow file must be owned by root, bin, or sys.</td>
<td>If the owner of the cron.allow file is not set to root, bin, or sys, the possibility exists for an unauthorized user to view or to edit sensitive information.</td>
<td></td>
<td># chown root /etc/cron.allow</td>
</tr>
<tr>
<td>V-4364</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The "at" directory must have mode 0755 or less permissive.</td>
<td>If the "at" directory has a mode more permissive than 0755, unauthorized users could be allowed to view or to edit files containing sensitive information within the "at" directory.  Unauthorized modifications could result in Denial of Service to authorized "at" jobs.</td>
<td></td>
<td>Change the mode of the "at" directory to 0755.

Procedure:
# chmod 0755 &lt;at directory&gt;</td>
</tr>
<tr>
<td>V-4367</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The at.allow file must be owned by root, bin, or sys.</td>
<td>If the owner of the at.allow file is not set to root, bin, or sys, unauthorized users could be allowed to view or edit sensitive information contained within the file.</td>
<td></td>
<td>Change the owner of the at.allow file.
# chown root /etc/at.allow</td>
</tr>
<tr>
<td>V-4368</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The at.deny file must be owned by root, bin, or sys.</td>
<td>If the owner of the at.deny file is not set to root, bin, or sys, unauthorized users could be allowed to view or edit sensitive information contained within the file.</td>
<td></td>
<td>Change the owner of the at.deny file.
# chown root /etc/at.deny</td>
</tr>
<tr>
<td>V-4369</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The traceroute command owner must be root.</td>
<td>If the traceroute command owner has not been set to root, an unauthorized user could use this command to obtain knowledge of the network topology inside the firewall.  This information may allow an attacker to determine trusted routers and other network information potentially leading to system and network compromise.</td>
<td></td>
<td>Change the owner of the traceroute command to root.
Example:
# chown root /bin/traceroute</td>
</tr>
<tr>
<td>V-4370</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The traceroute command must be group-owned by sys, bin, root, or system.</td>
<td>If the group owner of the traceroute command has not been set to a system group, unauthorized users could have access to the command and use it to gain information regarding a network's topology inside of the firewall.  This information may allow an attacker to determine trusted routers and other network information potentially leading to system and network compromise.</td>
<td></td>
<td>Change the group-owner of the traceroute command to root.

Procedure:
# chgrp root /bin/traceroute</td>
</tr>
<tr>
<td>V-4371</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The traceroute file must have mode 0700 or less permissive.</td>
<td>If the mode of the traceroute executable is more permissive than 0700, malicious code could be inserted by an attacker and triggered whenever the traceroute command is executed by authorized users.  Additionally, if an unauthorized user is granted executable permissions to the traceroute command, it could be used to gain information about the network topology behind the firewall.  This information may allow an attacker to determine trusted routers and other network information potentially leading to system and network compromise.</td>
<td></td>
<td>Change the mode of the traceroute command.
# chmod 0700 /bin/traceroute</td>
</tr>
<tr>
<td>V-4384</td>
<td>CCI-000366</td>
<td>low</td>
<td>The SMTP service's SMTP greeting must not provide version information.</td>
<td>The version of the SMTP service can be used by attackers to plan an attack based on vulnerabilities present in the specific version.</td>
<td></td>
<td>Ensure sendmail or Postfix has been configured to mask the version information.

Procedure
for sendmail:
Change the O SmtpGreetingMessage line in the /etc/mail/sendmail.cf file as noted below:
O SmtpGreetingMessage=$j Sendmail $v/$Z; $b
change it to:
O SmtpGreetingMessage= Mail Server Ready ; $b

for Postfix:
Examine the "smtpd_banner" line of /etc/postfix/main.conf and remove any "$mail_version" entry on it or comment the entire "smtpd_banner" line to use the default value which does not display the version information.</td>
</tr>
<tr>
<td>V-4385</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The system must not use .forward files.</td>
<td>The .forward file allows users to automatically forward mail to another system. Use of .forward files could allow the unauthorized forwarding of mail and could potentially create mail loops which could degrade system performance.</td>
<td></td>
<td>Disable forwarding for sendmail and remove .forward files from the system

Procedure:
Edit the /etc/mail/sendmail.mc file to change the ForwardPath entry to a null path by adding the line
define(`confFORWARD_PATH`,`')
rebuild the sendmail.cf file.

Remove all .forward files on the system
# find / -name .forward -delete</td>
</tr>
<tr>
<td>V-4387</td>
<td>CCI-000225</td>
<td>high</td>
<td>Anonymous FTP accounts must not have a functional shell.</td>
<td>If an anonymous FTP account has been configured to use a functional shell, attackers could gain access to the shell if the account is compromised.</td>
<td></td>
<td>Configure anonymous FTP accounts to use a non-functional shell. If necessary, edit the /etc/passwd file to remove any functioning shells associated with the ftp account and replace them with non-functioning shells, such as /dev/null.</td>
</tr>
<tr>
<td>V-4393</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/syslog.conf file must be owned by root.</td>
<td>If the /etc/syslog.conf file is not owned by root, unauthorized users could be allowed to view, edit, or delete important system messages handled by the syslog facility.</td>
<td></td>
<td>Use the chown command to set the owner to root.
# chown root /etc/syslog.conf</td>
</tr>
<tr>
<td>V-4394</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/syslog.conf file must be group-owned by root, bin, sys, or system.</td>
<td>If the group owner of /etc/syslog.conf is not root, bin, or sys, unauthorized users could be permitted to view, edit, or delete important system messages handled by the syslog facility.</td>
<td></td>
<td>Procedure:
# chgrp root /etc/syslog.conf</td>
</tr>
<tr>
<td>V-4428</td>
<td>CCI-000225</td>
<td>medium</td>
<td>All .rhosts, .shosts, .netrc, or hosts.equiv files must be accessible by only root or the owner.</td>
<td>If these files are accessible by users other than root or the owner, they could be used by a malicious user to set up a system compromise.</td>
<td></td>
<td>Ensure the permission for these files is set to 600 or more restrictive and their owner is root or the same as the owner of the home directory in which they reside.

Procedure:
# chmod 600 /etc/hosts.equiv
# chmod 600 /etc/ssh/shosts.equiv
# chown root /etc/hosts.equiv
# chown root /etc/ssh/shosts.equiv

# find / -name .rhosts
# chmod 600 /&lt;home directory&gt;/.rhosts
# chown &lt;home directory owner&gt; &lt;home directory&gt;/.rhosts

# find / -name .shosts
# chmod 600 &lt;directory location&gt;/.shosts
# chown &lt;home directory owner&gt; &lt;home directory&gt;/.shosts

# find / -name .netrc
# chmod 600 &lt;directory location&gt;/.netrc
# chown &lt;home directory owner&gt; &lt;home directory&gt;/.netrc</td>
</tr>
<tr>
<td>V-4430</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The cron.deny file must be owned by root, bin, or sys.</td>
<td>Cron daemon control files restrict the scheduling of automated tasks and must be protected.
</td>
<td></td>
<td># chown root /etc/cron.deny</td>
</tr>
<tr>
<td>V-4687</td>
<td>CCE-4141-8</td>
<td>high</td>
<td>The rsh daemon must not be running.</td>
<td>The rshd process provides a typically unencrypted, host-authenticated remote access service.  SSH should be used in place of this service.</td>
<td></td>
<td>Edit /etc/xinetd.d/rsh and set "disable=yes".</td>
</tr>
<tr>
<td>V-4688</td>
<td>CCI-001435</td>
<td>high</td>
<td>The rexec daemon must not be running.</td>
<td>The rexecd process provides a typically unencrypted, host-authenticated remote access service.  SSH should be used in place of this service.</td>
<td></td>
<td>Edit /etc/xinetd.d/rexec and set "disable=yes"</td>
</tr>
<tr>
<td>V-4692</td>
<td>CCI-000366</td>
<td>low</td>
<td>The SMTP service must not have the EXPN feature active.</td>
<td>The SMTP EXPN function allows an attacker to determine if an account exists on a system, providing significant assistance to a brute force attack on user accounts. EXPN may also provide additional information concerning users on the system, such as the full names of account owners.</td>
<td></td>
<td>Rebuild /etc/mail/sendmail.cf with the "noexpn" Privacy Flag set.

Procedure:
Edit /etc/mail/sendmail.mc resetting the Privacy Flags to the default:

define('confPRIVACYFLAGS', 'authwarnings,novrfy,noexpn,restrictqrun')dnl

Rebuild the sendmail.cf file with:
# make -C /etc/mail

Restart the sendmail service.
# service sendmail restart</td>
</tr>
<tr>
<td>V-4693</td>
<td>CCI-000366</td>
<td>low</td>
<td>The SMTP service must not have the Verify (VRFY) feature active.</td>
<td>The VRFY command allows an attacker to determine if an account exists on a system, providing significant assistance to a brute force attack on user accounts. VRFY may provide additional information about users on the system, such as the full names of account owners.</td>
<td></td>
<td>Add the "novrfy" flag to your sendmail in /etc/mail/sendmail.cf. 

Procedure:
Edit the definition of "confPRIVACY_FLAGS" in /etc/mail/sendmail.mc to include "novrfy".

Rebuild the sendmail.cf file with:
# make -C /etc/mail

Restart the sendmail service.
# service sendmail restart</td>
</tr>
<tr>
<td>V-4696</td>
<td>CCI-001436</td>
<td>medium</td>
<td>The system must not have the UUCP service active.</td>
<td>The UUCP utility is designed to assist in transferring files, executing remote commands, and sending e-mail between UNIX systems over phone lines and direct connections between systems. The UUCP utility is a primitive and arcane system with many security issues. There are alternate data transfer utilities/products that can be configured to more securely transfer data by providing for authentication as well as encryption.</td>
<td></td>
<td># chkconfig uucp off
# service uucp stop
# service xinetd restart</td>
</tr>
<tr>
<td>V-11940</td>
<td>CCI-001230</td>
<td>high</td>
<td>The operating system must be a supported release.</td>
<td>An operating system release is considered "supported" if the vendor continues to provide security patches for the product.  With an unsupported release, it will not be possible to resolve security issues discovered in the system software.</td>
<td></td>
<td>Upgrade to a supported version of the operating system.</td>
</tr>
<tr>
<td>V-11947</td>
<td>CCE-4154-1</td>
<td>medium</td>
<td>The system must require passwords contain a minimum of 14 characters.</td>
<td>The use of longer passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques by increasing the password search space.</td>
<td></td>
<td>Edit "/etc/pam.d/system-auth" to include the line:

password required pam_cracklib.so minlen=14

prior to the "password include system-auth-ac" line.</td>
</tr>
<tr>
<td>V-11948</td>
<td>CCE-14672-0</td>
<td>medium</td>
<td>The system must require passwords contain at least one uppercase alphabetic character.</td>
<td>To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.</td>
<td></td>
<td>Edit "/etc/pam.d/system-auth" to include the line:

password required pam_cracklib.so ucredit=-1

prior to the "password include system-auth-ac" line.</td>
</tr>
<tr>
<td>V-11972</td>
<td>CCE-14113-5</td>
<td>medium</td>
<td>The system must require passwords contain at least one numeric character.</td>
<td>To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated.  The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques.  Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.</td>
<td></td>
<td>Edit "/etc/pam.d/system-auth" to include the line:

password required pam_cracklib.so dcredit=-1

prior to the "password include system-auth-ac" line.</td>
</tr>
<tr>
<td>V-11973</td>
<td>CCE-14122-6</td>
<td>medium</td>
<td>The system must require passwords contain at least one special character.</td>
<td>To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated.  The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques.  Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.</td>
<td></td>
<td>Edit "/etc/pam.d/system-auth" to include the line:

password required pam_cracklib.so ocredit=-1

prior to the "password include system-auth-ac" line.</td>
</tr>
<tr>
<td>V-11975</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The system must require passwords contain no more than three consecutive repeating characters.</td>
<td>To enforce the use of complex passwords, the number of consecutive repeating characters is limited.  Passwords with excessive repeated characters may be more vulnerable to password-guessing attacks.</td>
<td></td>
<td>Edit "/etc/pam.d/system-auth" to include the line:

password required pam_cracklib.so maxrepeat=3

prior to the "password include system-auth-ac" line.</td>
</tr>
<tr>
<td>V-11976</td>
<td>CCE-4092-3</td>
<td>medium</td>
<td>User passwords must be changed at least every 60 days.</td>
<td>Limiting the lifespan of authenticators limits the period of time an unauthorized user has access to the system while using compromised credentials and reduces the period of time available for password-guessing attacks to run against a single password.</td>
<td></td>
<td>Set the max days field to 60 for all user accounts.
# passwd -x 60 &lt;user&gt;</td>
</tr>
<tr>
<td>V-11981</td>
<td>CCI-000225</td>
<td>medium</td>
<td>All global initialization files must have mode 0644 or less permissive.</td>
<td>Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon.</td>
<td></td>
<td>Change the mode of the global initialization file(s) to 0644.
# chmod 0644 &lt;global initialization file&gt;</td>
</tr>
<tr>
<td>V-11982</td>
<td>CCI-000225</td>
<td>medium</td>
<td>All global initialization files must be owned by root.</td>
<td>Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon.  Failure to give ownership of sensitive files or utilities to root or bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture.</td>
<td></td>
<td>Change the ownership of global initialization files with incorrect ownership.

Procedure:
# chown root &lt;global initialization files&gt;

or:
# ls etc/bashrc /etc/csh.cshrc /etc/csh.login /etc/csh.logout /etc/environment /etc/ksh.kshrc /etc/profile /etc/suid_profile /etc/profile.d/* 2&gt;null|xargs stat -L -c %U:%n|egrep -v "^root"|cut -d: -f2|xargs chown root
will set the owner of all files not currently owned by root to root.</td>
</tr>
<tr>
<td>V-11983</td>
<td>CCI-000225</td>
<td>medium</td>
<td>All global initialization files must be group-owned by root, sys, bin, other, system, or the system default.</td>
<td>Global initialization files are used to configure the user's shell environment upon login.  Malicious modification of these files could compromise accounts upon logon.  Failure to give ownership of sensitive files or utilities to root or bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture.</td>
<td></td>
<td>Change the group ownership of the global initialization file(s) with incorrect group ownership.

Procedure:
# chgrp root &lt;global initialization file&gt;
or:
# ls -lL /etc/bashrc /etc/csh.cshrc /etc/csh.login /etc/csh.logout /etc/environment /etc/ksh.kshrc /etc/profile /etc/suid_profile /etc/profile.d/* 2&gt;null|sed "s/^[^\/]*//"|xargs stat -L -c %G:%n|egrep -v "^(root|sys|bin|other):"|cut -d: -f2|xargs chgrp root
will set the group of all files not currently owned by an approved group to root.</td>
</tr>
<tr>
<td>V-11984</td>
<td>CCI-000225</td>
<td>medium</td>
<td>All skeleton files and directories (typically in /etc/skel) must be owned by root or bin.</td>
<td>If the skeleton files are not protected, unauthorized personnel could change user startup parameters and possibly jeopardize user files.  Failure to give ownership of sensitive files or utilities to root or bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the system's security posture.</td>
<td></td>
<td>Change the ownership of skeleton files with incorrect mode:
# chown root &lt;skeleton file&gt;
or
# ls -L /etc/skel|xargs stat -L -c %U:%n|egrep -v "^(root|bin):"|cut -d: -f2|chown root 
will change all files not owned by root or bin to root.</td>
</tr>
<tr>
<td>V-11985</td>
<td>CCI-000366</td>
<td>medium</td>
<td>All global initialization files' executable search paths must contain only absolute paths.</td>
<td>The executable search path (typically the PATH environment variable) contains a list of directories for the shell to search to find executables.  If this path includes the current working directory or other relative paths, executables in these directories may be executed instead of system commands.  This variable is formatted as a colon-separated list of directories.  If there is an empty entry, such as a leading or trailing colon, or two consecutive colons, this is interpreted as the current working directory.  Paths starting with a slash (/) are absolute paths.</td>
<td></td>
<td>Edit the global initialization file(s) with PATH variables containing relative paths. Edit the file and remove the relative path from the PATH variable.</td>
</tr>
<tr>
<td>V-11986</td>
<td>CCI-000366</td>
<td>medium</td>
<td>All local initialization files' executable search paths must contain only absolute paths.</td>
<td>The executable search path (typically the PATH environment variable) contains a list of directories for the shell to search to find executables.  If this path includes the current working directory or other relative paths, executables in these directories may be executed instead of system commands.  This variable is formatted as a colon-separated list of directories.  If there is an empty entry, such as a leading or trailing colon, or two consecutive colons, this is interpreted as the current working directory.  Paths starting with a slash (/) are absolute paths.</td>
<td></td>
<td>Edit the local initialization file and remove the relative path entry from the executable search path variable. If this is not feasable, justify and document the necessity of having the relative path for a specific application.</td>
</tr>
<tr>
<td>V-11988</td>
<td>CCI-000366</td>
<td>high</td>
<td>There must be no .rhosts, .shosts, hosts.equiv, or shosts.equiv files on the system.</td>
<td>The .rhosts, .shosts, hosts.equiv, and shosts.equiv files are used to configure host-based authentication for individual users or the system.  Host-based authentication is not sufficient for preventing unauthorized access to the system.</td>
<td></td>
<td>Remove all the r-commands access control files.

Procedure:
# find / -name .rhosts -exec rm {} \;
# find / -name .shosts -exec rm {} \;
# find / -name hosts.equiv -exec rm {} \;
# find / -name shosts.equiv -exec rm {} \;</td>
</tr>
<tr>
<td>V-11989</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The .rhosts file must not be supported in PAM.</td>
<td>.rhosts files are used to specify a list of hosts permitted remote access to a particular account without authenticating. The use of such a mechanism defeats strong identification and authentication requirements.</td>
<td></td>
<td>Edit the file(s) in /etc/pam.d referencing the rhosts_auth module, and remove the references to the rhosts_auth module.</td>
</tr>
<tr>
<td>V-11995</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Default system accounts (with the exception of root) must not be listed in the cron.allow file or must be included in the cron.deny file, if cron.allow does not exist.</td>
<td>To centralize the management of privileged account crontabs, of the default system accounts, only root may have a crontab.</td>
<td></td>
<td>Remove default system accounts (such as bin, sys, adm, or others, traditionally UID less than 500) from the cron.allow file if it exists, or add those accounts to the cron.deny file.</td>
</tr>
<tr>
<td>V-11996</td>
<td>CCE-4225-9</td>
<td>low</td>
<td>Process core dumps must be disabled unless needed.</td>
<td>Process core dumps contain the memory in use by the process when it crashed.  Process core dump files can be of significant size and their use can result in file systems filling to capacity, which may result in Denial of Service.  Process core dumps can be useful for software debugging.  </td>
<td></td>
<td>Edit /etc/security/limits.conf and set a hard limit for "core" to 0 for all users.</td>
</tr>
<tr>
<td>V-11997</td>
<td>CCI-000225</td>
<td>low</td>
<td>The kernel core dump data directory must be owned by root.</td>
<td>Kernel core dumps may contain the full contents of system memory at the time of the crash.  As the system memory may contain sensitive information, it must be protected accordingly. If the kernel core dump data directory is not owned by root, the core dumps contained in the directory may be subject to unauthorized access.</td>
<td></td>
<td>Change the owner of the kernel core dump data directory to root. 
# chown root /var/crash</td>
</tr>
<tr>
<td>V-11999</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The system must implement non-executable program stacks.</td>
<td>A common type of exploit is the stack buffer overflow.  An application receives, from an attacker, more data than it is prepared for and stores this information on its stack, writing beyond the space reserved for it.  This can be designed to cause execution of the data written on the stack.  One mechanism to mitigate this vulnerability is for the system to not allow the execution of instructions in sections of memory identified as part of the stack.</td>
<td></td>
<td>Examine /etc/sysctl.conf for "kernel.exec-shield" and "kernel.randomize_va_space" entries and if found remove them. The system default of "1" enables these modules.</td>
</tr>
<tr>
<td>V-12002</td>
<td>CCE-4236-6</td>
<td>medium</td>
<td>The system must not forward IPv4 source-routed packets.</td>
<td>Source-routed packets allow the source of the packet to suggest routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures.  This requirement applies only to the forwarding of source-routed traffic, such as when IPv4 forwarding is enabled and the system is functioning as a router.</td>
<td></td>
<td>Configure the system to not accept source-routed IPv4 packets.
Edit /etc/sysctl.conf and add a setting for "net.ipv4.conf.all.accept_source_route=0" and "net.ipv4.conf.default.accept_source_route=0". 

Reload the sysctls.
Procedure:
# sysctl -p</td>
</tr>
<tr>
<td>V-12003</td>
<td>CCI-001208</td>
<td>low</td>
<td>A separate file system must be used for user home directories (such as /home or an equivalent).</td>
<td>The use of separate file systems for different paths can protect the system from failures resulting from a file system becoming full or failing.</td>
<td></td>
<td>Migrate the /home (or equivalent) path onto a separate file system.</td>
</tr>
<tr>
<td>V-12004</td>
<td>CCI-000126</td>
<td>medium</td>
<td>The system must log informational authentication data.</td>
<td>Monitoring and recording successful and unsuccessful logins assists in tracking unauthorized access to the system.</td>
<td></td>
<td>Edit /etc/syslog.conf and add local log destinations for "authpriv.*", "authpriv.debug" or "authpriv.info".</td>
</tr>
<tr>
<td>V-12005</td>
<td>CCI-000305</td>
<td>medium</td>
<td>Inetd and xinetd must be disabled or removed if no network services utilizing them are enabled.</td>
<td>Unnecessary services should be disabled to decrease the attack surface of the system.</td>
<td></td>
<td># service xinetd stop ; chkconfig xinetd off</td>
</tr>
<tr>
<td>V-12006</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The SMTP service HELP command must not be enabled.</td>
<td>The HELP command should be disabled to mask version information.  The version of the SMTP service software could be used by attackers to target vulnerabilities present in specific software versions.</td>
<td></td>
<td>To disable the SMTP HELP command, remove /etc/mail/helpfile.</td>
</tr>
<tr>
<td>V-12011</td>
<td>CCI-000225</td>
<td>medium</td>
<td>All FTP users must have a default umask of 077.</td>
<td>The umask controls the default access mode assigned to newly created files. An umask of 077 limits new files to mode 700 or less permissive. Although umask is stored as a 4-digit number, the first digit representing special access modes is typically ignored or required to be zero (0).</td>
<td></td>
<td>Edit the initialization files for the ftp user and set the umask to 077.

Procedure:

For gssftp:
Modify the /etc/xinetd.d/gssftp file adding "-u 077" to the server_args entry.

For vsftp:
Modify the "/etc/vsftpd/vsftpd.conf" setting "local_umask" and "anon_umask" to 077.</td>
</tr>
<tr>
<td>V-12019</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The snmpd.conf file must be owned by root.</td>
<td>The snmpd.conf file contains authenticators and must be protected from unauthorized access and modification.  If the file is not owned by root, it may be subject to access and modification from unauthorized users.</td>
<td></td>
<td>Change the owner of the snmpd.conf file to root.

Procedure:
# chown root &lt;snmpd.conf file&gt;</td>
</tr>
<tr>
<td>V-12023</td>
<td>CCE-3561-8</td>
<td>medium</td>
<td>IP forwarding for IPv4 must not be enabled, unless the system is a router.</td>
<td>If the system is configured for IP forwarding and is not a designated router, it could be used to bypass network security by providing a path for communication not filtered by network devices.</td>
<td></td>
<td>Edit "/etc/sysctl.conf" and set net.ipv4.ip_forward to "0". Restart the system or run "sysctl -p" to make the change take effect.</td>
</tr>
<tr>
<td>V-12030</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The system's access control program must be configured to grant or deny system access to specific hosts.</td>
<td>If the system's access control program is not configured with appropriate rules for allowing and denying access to system network resources, services may be accessible to unauthorized hosts.</td>
<td></td>
<td>Edit the "/etc/hosts.all" and "/etc/hosts.deny" files to configure access restrictions.</td>
</tr>
<tr>
<td>V-12039</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/securetty file must be owned by root.</td>
<td>The securetty file contains the list of terminals permitting direct root logins.  It must be protected from unauthorized modification.</td>
<td></td>
<td>Change the owner of the /etc/securetty file to root.

Procedure:
# chown root /etc/securetty</td>
</tr>
<tr>
<td>V-12040</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/securetty file must have mode 0640 or less permissive.</td>
<td>The securetty file contains the list of terminals permitting direct root logins.  It must be protected from unauthorized modification.</td>
<td></td>
<td>Change the mode of the /etc/securetty file to 0600.

Procedure:
# chmod 0600 /etc/securetty</td>
</tr>
<tr>
<td>V-22290</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The system clock must be synchronized continuously, or at least daily.</td>
<td>A synchronized system clock is critical for the enforcement of time-based policies and the correlation of logs and audit records with other systems.  Internal system clocks tend to drift and require periodic resynchronization to ensure their accuracy.  Software, such as ntpd, can be used to continuously synchronize the system clock with authoritative sources.  Alternatively, the system may be synchronized periodically, with a maximum of one day between synchronizations.

If the system is completely isolated (i.e., it has no connections to networks or other systems), time synchronization is not required as no correlation of events or operation of time-dependent protocols between systems will be necessary. If the system is completely isolated, this requirement is not applicable.</td>
<td></td>
<td>Enable the NTP daemon for continuous synchronization.
# service ntpd start ; chkconfig ntpd on

OR

Add a daily or more frequent cronjob to perform synchronization using ntpdate.</td>
</tr>
<tr>
<td>V-22294</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The time synchronization configuration file (such as /etc/ntp.conf) must be owned by root.</td>
<td>A synchronized system clock is critical for the enforcement of time-based policies and the correlation of logs and audit records with other systems.  If an illicit time source is used for synchronization, the integrity of system logs and the security of the system could be compromised.  If the configuration files controlling time synchronization are not owned by a system account, unauthorized modifications could result in the failure of time synchronization.</td>
<td></td>
<td>Change the owner of the NTP configuration file.
# chown root /etc/ntp.conf</td>
</tr>
<tr>
<td>V-22296</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The time synchronization configuration file (such as /etc/ntp.conf) must have mode 0640 or less permissive.</td>
<td>A synchronized system clock is critical for the enforcement of time-based policies and the correlation of logs and audit records with other systems.  If an illicit time source is used for synchronization, the integrity of system logs and the security of the system could be compromised.  If the configuration files controlling time synchronization are not protected, unauthorized modifications could result in the failure of time synchronization.</td>
<td></td>
<td>Change the mode of the NTP configuration file to 0640 or more restrictive.
# chmod 0640 /etc/ntp.conf</td>
</tr>
<tr>
<td>V-22298</td>
<td>CCI-000054</td>
<td>low</td>
<td>The system must limit users to 10 simultaneous system logins, or a site-defined number, in accordance with operational requirements.</td>
<td>Limiting simultaneous user logins can insulate the system from denial of service problems caused by excessive logins.  Automated login processes operating improperly or maliciously may result in an exceptional number of simultaneous login sessions.

If the defined value of 10 logins does not meet operational requirements, the site may define the permitted number of simultaneous login sessions based on operational requirements.

This limit is for the number of simultaneous login sessions for EACH user account.  This is NOT a limit on the total number of simultaneous login sessions on the system.</td>
<td></td>
<td>Add a "maxlogins" line such as "* hard maxlogins 10" to /etc/security/limits.conf or a file in /etc/security/limits.d. The enforced maximum should be defined by site requirements and policy.</td>
</tr>
<tr>
<td>V-22302</td>
<td>CCI-000205</td>
<td>medium</td>
<td>The system must enforce compliance of the entire password during authentification.</td>
<td>Some common password hashing schemes only process the first eight characters of a user's password, which reduces the effective strength of the password.</td>
<td></td>
<td>Change the passwords for all accounts using non-compliant password hashes. 

(This requires GEN000590 is already met.)</td>
</tr>
<tr>
<td>V-22303</td>
<td>CCE-14063-2</td>
<td>medium</td>
<td>The system must use a FIPS 140-2 approved cryptographic hashing algorithm for generating account password hashes.</td>
<td>Systems must employ cryptographic hashes for passwords using the SHA-2 family of algorithms or FIPS 140-2 approved successors.  The use of unapproved algorithms may result in weak password hashes more vulnerable to compromise.</td>
<td></td>
<td>Change the default password algorithm.
# authconfig --passalgo=sha512 --update</td>
</tr>
<tr>
<td>V-22304</td>
<td>CCI-000196</td>
<td>medium</td>
<td>The password hashes stored on the system must have been generated using a FIPS 140-2 approved cryptographic hashing algorithm.</td>
<td>Systems must employ cryptographic hashes for passwords using the SHA-2 family of algorithms or FIPS 140-2 approved successors.  The use of unapproved algorithms may result in weak password hashes more vulnerable to compromise.</td>
<td></td>
<td>Change the passwords for all accounts using non-compliant password hashes. 

(This requires GEN000590 is already met.)</td>
</tr>
<tr>
<td>V-22305</td>
<td>CCE-14712-4</td>
<td>medium</td>
<td>The system must require passwords contain at least one lowercase alphabetic character.</td>
<td>To enforce the use of complex passwords, minimum numbers of characters of different classes are mandated.  The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques.  Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use.</td>
<td></td>
<td>Edit "/etc/pam.d/system-auth" to include the line:

password required pam_cracklib.so lcredit=-1

prior to the "password include system-auth-ac" line.</td>
</tr>
<tr>
<td>V-22306</td>
<td>CCE-14701-7</td>
<td>medium</td>
<td>The system must require at least four characters be changed between the old and new passwords during a password change.</td>
<td>To ensure password changes are effective in their goals, the system must ensure that old and new passwords have significant differences.  Without significant changes, new passwords may be easily guessed based on the value of a previously compromised password.</td>
<td></td>
<td>If /etc/pam.d/system-auth references /etc/pam.d/system-auth-ac refer to the man page for system-auth-ac for a description of how to add options not configurable with authconfig. Edit /etc/pam.d/system-auth and add or edit a pam_cracklib entry with an difok parameter set equal to or greater than 4.</td>
</tr>
<tr>
<td>V-22307</td>
<td>CCI-000189</td>
<td>medium</td>
<td>The system must prevent the use of dictionary words for passwords.</td>
<td>An easily guessable password provides an open door to any external or internal malicious intruder.  Many computer compromises occur as the result of account name and password guessing.  This is generally done by someone with an automated script that uses repeated logon attempts until the correct account and password pair is guessed.  Utilities, such as cracklib, can be used to validate passwords are not dictionary words and meet other criteria during password changes.</td>
<td></td>
<td>If /etc/pam.d/system-auth references /etc/pam.d/system-auth-ac refer to the man page for system-auth-ac for a description of how to add options not configurable with authconfig. Edit /etc/pam.d/system-auth and configure pam_cracklib by adding a line such as "password required pam_cracklib.so"</td>
</tr>
<tr>
<td>V-22308</td>
<td>CCE-15047-4</td>
<td>low</td>
<td>The system must restrict the ability to switch to the root user to members of a defined group.</td>
<td>Configuring a supplemental group for users permitted to switch to the root user prevents unauthorized users from accessing the root account, even with knowledge of the root credentials.</td>
<td></td>
<td>Edit /etc/pam.d/su and uncomment or add a line such as "auth required pam_wheel.so". If necessary, create a "wheel" group and add administrative users to the group.</td>
</tr>
<tr>
<td>V-22310</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The root account's library search path must be the system default and must contain only absolute paths.</td>
<td>The library search path environment variable(s) contain a list of directories for the dynamic linker to search to find libraries.  If this path includes the current working directory or other relative paths, libraries in these directories may be loaded instead of system libraries.  This variable is formatted as a colon-separated list of directories.  If there is an empty entry, such as a leading or trailing colon or two consecutive colons, this is interpreted as the current working directory.  Entries starting with a slash (/) are absolute paths.</td>
<td></td>
<td>Edit the root user initialization files and remove any definition of LD_LIBRARY_PATH.</td>
</tr>
<tr>
<td>V-22311</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The root account's list of preloaded libraries must be empty.</td>
<td>The library preload list environment variable contains a list of libraries for the dynamic linker to load before loading the libraries required by the binary.  If this list contains paths to libraries relative to the current working directory, unintended libraries may be preloaded.  This variable is formatted as a space-separated list of libraries.  Paths starting with (/) are absolute paths.</td>
<td></td>
<td>Edit the root user initialization files and remove any definition of LD_PRELOAD.</td>
</tr>
<tr>
<td>V-22319</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/resolv.conf file must be owned by root.</td>
<td>The resolv.conf (or equivalent) file configures the system's DNS resolver.  DNS is used to resolve host names to IP addresses.  If DNS configuration is modified maliciously, host name resolution may fail or return incorrect information.  DNS may be used by a variety of system security functions such as time synchronization, centralized authentication, and remote system logging.
</td>
<td></td>
<td>Change the owner of the /etc/resolv.conf file to root.
# chown root /etc/resolv.conf</td>
</tr>
<tr>
<td>V-22321</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/resolv.conf file must have mode 0644 or less permissive.</td>
<td>The resolv.conf (or equivalent) file configures the system's DNS resolver.  DNS is used to resolve host names to IP addresses.  If DNS configuration is modified maliciously, host name resolution may fail or return incorrect information.  DNS may be used by a variety of system security functions such as time synchronization, centralized authentication, and remote system logging.</td>
<td></td>
<td>Change the mode of the /etc/resolv.conf file to 0644.
# chmod 0644 /etc/resolv.conf</td>
</tr>
<tr>
<td>V-22323</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/hosts file must be owned by root.</td>
<td>The /etc/hosts file (or equivalent) configures local host name to IP address mappings that typically take precedence over DNS resolution.  If this file is maliciously modified, it could cause the failure or compromise of security functions requiring name resolution, which may include time synchronization, centralized authentication, and remote system logging.</td>
<td></td>
<td>Change the owner of the /etc/hosts file to root.
# chown root /etc/hosts</td>
</tr>
<tr>
<td>V-22325</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/hosts file must have mode 0644 or less permissive.</td>
<td>The /etc/hosts file (or equivalent) configures local host name to IP address mappings that typically take precedence over DNS resolution.  If this file is maliciously modified, it could cause the failure or compromise of security functions requiring name resolution, which may include time synchronization, centralized authentication, and remote system logging.</td>
<td></td>
<td>Change the mode of the /etc/hosts file to 0644.
# chmod 0644 /etc/hosts</td>
</tr>
<tr>
<td>V-22327</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/nsswitch.conf file must be owned by root.</td>
<td>The nsswitch.conf file (or equivalent) configures the source of a variety of system security information including account, group, and host lookups.  Malicious changes could prevent the system from functioning or compromise system security.</td>
<td></td>
<td>Change the owner of the /etc/nsswitch.conf file to root.
# chown root /etc/nsswitch.conf</td>
</tr>
<tr>
<td>V-22328</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/nsswitch.conf file must be group-owned by root, bin, or sys.</td>
<td>The nsswitch.conf file (or equivalent) configures the source of a variety of system security information including account, group, and host lookups.  Malicious changes could prevent the system from functioning or compromise system security.</td>
<td></td>
<td>Change the group-owner of the /etc/nsswitch.conf file to root, bin or sys.

Procedure:
# chgrp root /etc/nsswitch.conf</td>
</tr>
<tr>
<td>V-22329</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/nsswitch.conf file must have mode 0644 or less permissive.</td>
<td>The nsswitch.conf file (or equivalent) configures the source of a variety of system security information including account, group, and host lookups.  Malicious changes could prevent the system from functioning or compromise system security.</td>
<td></td>
<td>Change the mode of the /etc/nsswitch.conf file to 0644 or less permissive.
# chmod 0644 /etc/nsswitch.conf</td>
</tr>
<tr>
<td>V-22332</td>
<td>CCE-3958-6</td>
<td>medium</td>
<td>The /etc/passwd file must be owned by root.</td>
<td>The /etc/passwd file contains the list of local system accounts.  It is vital to system security and must be protected from unauthorized modification.</td>
<td></td>
<td>Change the owner of the /etc/passwd file to root.
# chown root /etc/passwd</td>
</tr>
<tr>
<td>V-22333</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/passwd file must be group-owned by root, bin, or sys.</td>
<td>The /etc/passwd file contains the list of local system accounts.  It is vital to system security and must be protected from unauthorized modification.</td>
<td></td>
<td>Change the group-owner of the /etc/passwd file to root, bin or sys.

Procedure:
# chgrp root /etc/passwd</td>
</tr>
<tr>
<td>V-22335</td>
<td>CCE-3276-3</td>
<td>medium</td>
<td>The /etc/group file must be owned by root.</td>
<td>The /etc/group file is critical to system security and must be owned by a privileged user.  The group file contains a list of system groups and associated information.</td>
<td></td>
<td>Change the owner of the /etc/group file to root.
# chown root /etc/group</td>
</tr>
<tr>
<td>V-22336</td>
<td>CCE-3495-9</td>
<td>medium</td>
<td>The /etc/group file must be group-owned by root, bin, or sys.</td>
<td>The /etc/group file is critical to system security and must be protected from unauthorized modification.  The group file contains a list of system groups and associated information.</td>
<td></td>
<td>Change the group-owner of the /etc/group file.

Procedure:
# chgrp root /etc/group</td>
</tr>
<tr>
<td>V-22337</td>
<td>CCE-3967-7</td>
<td>medium</td>
<td>The /etc/group file must have mode 0644 or less permissive.</td>
<td>The /etc/group file is critical to system security and must be protected from unauthorized modification.  The group file contains a list of system groups and associated information.</td>
<td></td>
<td>Change the mode of the /etc/group file to 0644 or less permissive.
# chmod 0644 /etc/group</td>
</tr>
<tr>
<td>V-22339</td>
<td>CCE-3988-3</td>
<td>medium</td>
<td>The /etc/shadow file (or equivalent) must be group-owned by root, bin,or sys.</td>
<td>The /etc/shadow file contains the list of local system accounts.  It is vital to system security and must be protected from unauthorized modification.  The file also contains password hashes which must not be accessible to users other than root.</td>
<td></td>
<td>Change the group-owner of the /etc/shadow file.

Procedure:
# chgrp root /etc/shadow</td>
</tr>
<tr>
<td>V-22341</td>
<td>CCE-4210-1</td>
<td>medium</td>
<td>The /etc/gshadow file must be owned by root.</td>
<td>The /etc/gshadow file is critical to system security and must be owned by a privileged user.  The /etc/gshadow file contains a list of system groups and hashes for group passwords.</td>
<td></td>
<td>Change the owner of the /etc/gshadow file to root.
# chown root /etc/gshadow</td>
</tr>
<tr>
<td>V-22342</td>
<td>CCE-4064-2</td>
<td>medium</td>
<td>The /etc/gshadow file must be group-owned by root.</td>
<td>The /etc/gshadow file is critical to system security and must be protected from unauthorized modification.   The /etc/gshadow file contains a list of system groups and hashes for group passwords.</td>
<td></td>
<td>Change the group-owner of the /etc/gshadow file to root.
# chgrp root /etc/gshadow</td>
</tr>
<tr>
<td>V-22343</td>
<td>CCE-3932-1</td>
<td>medium</td>
<td>The /etc/gshadow file must have mode 0400.</td>
<td>The /etc/gshadow file is critical to system security and must be protected from unauthorized modification.   The /etc/gshadow file contains a list of system groups and hashes for group passwords.</td>
<td></td>
<td>Change the mode of the /etc/gshadow file to 0400 or less permissive.
# chmod 0400 /etc/gshadow</td>
</tr>
<tr>
<td>V-22347</td>
<td>CCI-000201</td>
<td>medium</td>
<td>The /etc/passwd file must not contain password hashes.</td>
<td>If password hashes are readable by non-administrators, the passwords are subject to attack through lookup tables or cryptographic weaknesses in the hashes.</td>
<td></td>
<td>Migrate /etc/passwd password hashes to /etc/shadow.
# pwconv</td>
</tr>
<tr>
<td>V-22348</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/group file must not contain any group password hashes.</td>
<td>Group passwords are typically shared and should not be used.  Additionally, if password hashes are readable by non-administrators, the passwords are subject to attack through lookup tables or cryptographic weaknesses in the hashes.</td>
<td></td>
<td>Edit /etc/group and change the password field to an exclamation point (!) to lock the group password.</td>
</tr>
<tr>
<td>V-22349</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The /etc/gshadow file must not contain any group password hashes.</td>
<td>Group passwords are typically shared and should not be used.</td>
<td></td>
<td>Edit /etc/gshadow and change the password field to an exclamation point (!) to lock the group password.</td>
</tr>
<tr>
<td>V-22355</td>
<td>CCI-000366</td>
<td>medium</td>
<td>Run control scripts' lists of preloaded libraries must contain only absolute paths.</td>
<td>The library preload list environment variable contains a list of libraries for the dynamic linker to load before loading the libraries required by the binary.  If this list contains paths to libraries relative to the current working directory, unintended libraries may be preloaded.  This variable is formatted as a space-separated list of libraries.  Paths starting with a slash (/) are absolute paths.</td>
<td></td>
<td>Edit the run control script and remove the relative path entry from the library preload variable.</td>
</tr>
<tr>
<td>V-22358</td>
<td>CCI-000225</td>
<td>medium</td>
<td>All skeleton files (typically in /etc/skel) must be group-owned by root, bin, sys, system, or other.</td>
<td>If the skeleton files are not protected, unauthorized personnel could change user startup parameters and possibly jeopardize user files.</td>
<td></td>
<td>Change the group-owner of the skeleton file to root, bin, sys, system, or other.

Procedure:
# chgrp &lt;group&gt; /etc/skel/[skeleton file]
or:
# ls -L /etc/skel|xargs stat -L -c %G:%n|egrep -v "^(root|bin|sy|sytem|other):"|cut -d: -f2|chgrp root
will change the group of all files not already one of the approved group to root.</td>
</tr>
<tr>
<td>V-22365</td>
<td>CCI-000225</td>
<td>medium</td>
<td>All shell files must be group-owned by root, bin, sys, or system.</td>
<td>If shell files are group-owned by users other than root or a system group, they could be modified by intruders or malicious users to perform unauthorized actions.</td>
<td></td>
<td>Change the group-owner of the shell to root, bin, sys, or system.

Procedure:
# chgrp root &lt;shell&gt;</td>
</tr>
<tr>
<td>V-22370</td>
<td>CCI-001493</td>
<td>low</td>
<td>System audit tool executables must be owned by root.</td>
<td>To prevent unauthorized access or manipulation of system audit logs, the tools for manipulating those logs must be protected.</td>
<td></td>
<td>Change the owner of the audit tool executable to root.
# chown root [audit tool executable]</td>
</tr>
<tr>
<td>V-22371</td>
<td>CCI-001493</td>
<td>low</td>
<td>System audit tool executables must be group-owned by root, bin, sys, or system.</td>
<td>To prevent unauthorized access or manipulation of system audit logs, the tools for manipulating those logs must be protected.</td>
<td></td>
<td>Change the group-owner of the audit tool executable to root, bin, sys, or system.

Procedure:
# chgrp root &lt;audit tool executable&gt;</td>
</tr>
<tr>
<td>V-22372</td>
<td>CCI-001493</td>
<td>low</td>
<td>System audit tool executables must have mode 0750 or less permissive.</td>
<td>To prevent unauthorized access or manipulation of system audit logs, the tools for manipulating those logs must be protected.</td>
<td></td>
<td>Change the mode of the audit tool executable to 0750, or less permissive.
# chmod 0750 [audit tool executable]</td>
</tr>
<tr>
<td>V-22374</td>
<td>CCI-000139</td>
<td>low</td>
<td>The audit system must alert the SA in the event of an audit processing failure.</td>
<td>An accurate and current audit trail is essential for maintaining a record of system activity.  If the system fails, the SA must be notified and must take prompt action to correct the problem.

Minimally, the system must log this event and the SA will receive this notification during the daily system log review.  If feasible, active alerting (such as e-mail or paging) should be employed consistent with the sites established operations management systems and procedures.</td>
<td></td>
<td>Edit /etc/audit/auditd.conf and set the disk_full_action and/or disk_error_action parameters to a valid setting of "syslog", "exec", "single" or "halt", adding the parameters if necessary.</td>
</tr>
<tr>
<td>V-22375</td>
<td>CCI-000143</td>
<td>medium</td>
<td>The audit system must alert the SA when the audit storage volume approaches its capacity.</td>
<td>An accurate and current audit trail is essential for maintaining a record of system activity.  If the system fails, the SA must be notified and must take prompt action to correct the problem.

Minimally, the system must log this event and the SA will receive this notification during the daily system log review.  If feasible, active alerting (such as e-mail or paging) should be employed consistent with the sites established operations management systems and procedures.</td>
<td></td>
<td>Edit /etc/audit/auditd.conf and set the space_left_action parameter to a valid setting other than "ignore". If the space_left_action parameter is set to "email" set the action_mail_acct parameter to an e-mail address for the system administrator.</td>
</tr>
<tr>
<td>V-22376</td>
<td>CCI-000018</td>
<td>low</td>
<td>The audit system must be configured to audit account creation.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises, and damages incurred during a system compromise.</td>
<td></td>
<td>Configure execute auditing of the useradd and groupadd executables.
Add the following to audit.rules:
-w /usr/sbin/useradd -p x -k useradd
-w /usr/sbin/groupadd -p x -k groupadd
Configure append auditing of the passwd, shadow, group, and gshadow files.  Add the following to audit.rules:
-w /etc/passwd -p a -k passwd
-w /etc/shadow -p a -k shadow
-w /etc/group -p a -k group
-w /etc/gshadow -p a -k gshadow
Restart the auditd service.</td>
</tr>
<tr>
<td>V-22377</td>
<td>CCI-001403</td>
<td>low</td>
<td>The audit system must be configured to audit account modification.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>Configure execute auditing of the usermod and groupmod executables.  Add the following to the audit.rules file:
-w /usr/sbin/usermod -p x -k usermod
-w /usr/sbin/groupmod -p x -k groupmod
Configure append auditing of the passwd, shadow, group, and gshadow files.  Add the following to the audit.rules file:
-w /etc/passwd -p w -k passwd
-w /etc/shadow -p w -k shadow
-w /etc/group -p w -k group
-w /etc/gshadow -p w -k gshadow
Restart the auditd service.</td>
</tr>
<tr>
<td>V-22378</td>
<td>CCI-001404</td>
<td>low</td>
<td>The audit system must be configured to audit account disabling.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>Configure execute auditing of the passwd executable.  Add the following to the audit.rules file:
-w /usr/bin/passwd -p x -k passwd

Restart the auditd service.</td>
</tr>
<tr>
<td>V-22382</td>
<td>CCI-001405</td>
<td>low</td>
<td>The audit system must be configured to audit account termination.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>Configure execute auditing of the userdel and groupdel executables. Add the following to the audit.rules file:
-w /usr/sbin/userdel -p x 
-w /usr/sbin/groupdel -p x

Restart the auditd service.</td>
</tr>
<tr>
<td>V-22383</td>
<td>CCE-14688-6</td>
<td>medium</td>
<td>The audit system must be configured to audit the loading and unloading of dynamic kernel modules.</td>
<td>Actions concerning dynamic kernel modules must be recorded as they are substantial events.  Dynamic kernel modules can increase the attack surface of a system.  A malicious kernel module can be used to substantially alter the functioning of a system, often with the purpose of hiding a compromise from the SA.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.
Procedure:
Configure auditing of the init_module syscalls.
Add the following to the "etc/audit/audit.rules" or "etc/audit.rules" file:

-a exit,always -S init_module

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-22385</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Crontab files must be group-owned by root, cron, or the crontab creator's primary group.</td>
<td>To protect the integrity of scheduled system jobs and prevent malicious modification to these jobs, crontab files must be secured.</td>
<td></td>
<td>Change the group owner of the crontab file to root, cron, or the crontab's primary group.
Procedure:
# chgrp root [crontab file]</td>
</tr>
<tr>
<td>V-22391</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The cron.allow file must be group-owned by root, bin, sys, or cron.</td>
<td>If the group of the cron.allow is not set to root, bin, sys, or cron, the possibility exists for an unauthorized user to view or edit the list of users permitted to use cron.  Unauthorized modification of this file could cause Denial of Service to authorized cron users or provide unauthorized users with the ability to run cron jobs.</td>
<td></td>
<td>Change the group ownership of the file.

Procedure:
# chgrp root /etc/cron.allow</td>
</tr>
<tr>
<td>V-22392</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The at.deny file must have mode 0600 or less permissive.</td>
<td>The "at" daemon control files restrict access to scheduled job manipulation and must be protected.  Unauthorized modification of the at.deny file could result in Denial of Service to authorized "at" users or provide unauthorized users with the ability to run "at" jobs.</td>
<td></td>
<td>Change the mode of the file.
# chmod 0600 /etc/at.deny</td>
</tr>
<tr>
<td>V-22396</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The "at" directory must be group-owned by root, bin, sys, or cron.</td>
<td>If the group of the "at" directory is not root, bin, sys, or cron, unauthorized users could be allowed to view or edit files containing sensitive information within the directory.</td>
<td></td>
<td>Change the group ownership of the file to root, bin, sys, daemon or cron.

Procedure:
# chgrp &lt;root or other system group&gt; &lt;"at" directory&gt;</td>
</tr>
<tr>
<td>V-22404</td>
<td>CCE-3425-6</td>
<td>medium</td>
<td>Kernel core dumps must be disabled unless needed.</td>
<td>Kernel core dumps may contain the full contents of system memory at the time of the crash.  Kernel core dumps may consume a considerable amount of disk space and may result in Denial of Service by exhausting the available space on the target file system.  The kernel core dump process may increase the amount of time a system is unavailable due to a crash.  Kernel core dumps can be useful for kernel debugging.</td>
<td></td>
<td>Disable kdump.
# service kdump stop
# chkconfig kdump off</td>
</tr>
<tr>
<td>V-22405</td>
<td>CCI-000225</td>
<td>low</td>
<td>The kernel core dump data directory must be group-owned by root, bin, sys, or system.</td>
<td>Kernel core dumps may contain the full contents of system memory at the time of the crash.  As the system memory may contain sensitive information, it must be protected accordingly.  If the kernel core dump data directory is not group-owned by a system group, the core dumps contained in the directory may be subject to unauthorized access.</td>
<td></td>
<td>Change the group-owner of the kernel core dump data directory.
# chgrp root &lt;kernel core dump data directory&gt;</td>
</tr>
<tr>
<td>V-22406</td>
<td>CCI-000225</td>
<td>low</td>
<td>The kernel core dump data directory must have mode 0700 or less permissive.</td>
<td>Kernel core dumps may contain the full contents of system memory at the time of the crash.  As the system memory may contain sensitive information, it must be protected accordingly.  If the mode of the kernel core dump data directory is more permissive than 0700, unauthorized users may be able to view or to modify kernel core dump data files.</td>
<td></td>
<td>Change the group-owner of the kernel core dump data directory.
# chmod 0700 &lt;kernel core dump data directory&gt;</td>
</tr>
<tr>
<td>V-22408</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Network interfaces must not be configured to allow user control.</td>
<td>Configuration of network interfaces should be limited to privileged users.  Manipulation of network interfaces may result in a Denial of Service or bypass of network security mechanisms.</td>
<td></td>
<td>Edit the configuration for the user-controlled interface and remove the "USERCTL=yes" configuration line or set to "USERCTL=no".</td>
</tr>
<tr>
<td>V-22410</td>
<td>CCE-3644-2</td>
<td>medium</td>
<td>The system must not respond to Internet Control Message Protocol v4 (ICMPv4) echoes sent to a broadcast address.</td>
<td>Responding to broadcast (ICMP) echoes facilitates network mapping and provides a vector for amplification attacks.</td>
<td></td>
<td>Configure the system to not respond to ICMP ECHO_REQUESTs sent to broadcast addresses. Edit /etc/sysctl.conf and add a setting for "net.ipv4.icmp_echo_ignore_broadcasts=1" and reload the sysctls.

Procedure:
# echo "net.ipv4.icmp_echo_ignore_broadcasts=1" &gt;&gt; /etc/sysctl.conf
# sysctl -p</td>
</tr>
<tr>
<td>V-22411</td>
<td>CCI-001551</td>
<td>medium</td>
<td>The system must not respond to Internet Control Message Protocol (ICMP) timestamp requests sent to a broadcast address.</td>
<td>The processing of (ICMP) timestamp requests increases the attack surface of the system.  Responding to broadcast ICMP timestamp requests facilitates network mapping and provides a vector for amplification attacks.</td>
<td></td>
<td>Configure the system to not respond to ICMP TIMESTAMP_REQUESTs sent to broadcast addresses. Edit /etc/sysctl.conf and add a setting for "net.ipv4.icmp_echo_ignore_broadcasts=1" and reload the sysctls.

Procedure:
# echo "net.ipv4.icmp_echo_ignore_broadcasts=1" &gt;&gt; /etc/sysctl.conf
# sysctl -p</td>
</tr>
<tr>
<td>V-22414</td>
<td>CCI-001551</td>
<td>medium</td>
<td>The system must not accept source-routed IPv4 packets.</td>
<td>Source-routed packets allow the source of the packet to suggest routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures.  This requirement applies only to the handling of source-routed traffic destined to the system itself, not to traffic forwarded by the system to another system, such as when IPv4 forwarding is enabled and the system is functioning as a router.</td>
<td></td>
<td>Configure the system to not accept source-routed IPv4 packets.
Edit /etc/sysctl.conf and add a setting for "net.ipv4.conf.all.accept_source_route=0" and "net.ipv4.conf.default.accept_source_route=0". 

Reload the sysctls.
Procedure:
# sysctl -p</td>
</tr>
<tr>
<td>V-22415</td>
<td>CCI-001551</td>
<td>medium</td>
<td>Proxy Address Resolution Protocol (Proxy ARP) must not be enabled on the system.</td>
<td>Proxy ARP allows a system to respond to ARP requests on one interface on behalf of hosts connected to another interface.  If this function is enabled when not required, addressing information may be leaked between the attached network segments.</td>
<td></td>
<td>Configure the system to not use proxy ARP.
Edit /etc/sysctl.conf and add a setting for "net.ipv4.conf.all.proxy_arp=0" and "net.ipv4.conf.default.proxy_arp=0".
# sysctl -p</td>
</tr>
<tr>
<td>V-22416</td>
<td>CCE-4217-6</td>
<td>medium</td>
<td>The system must ignore IPv4 Internet Control Message Protocol (ICMP) redirect messages.</td>
<td>ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated.  An illicit ICMP redirect message could result in a man-in-the-middle attack.</td>
<td></td>
<td>Configure the system to not accept IPv4 ICMP redirect messages.
Edit /etc/sysctl.conf and add a setting for "net.ipv4.conf.all.accept_redirects=0" and "net.ipv4.conf.default.accept_redirects=0".
# sysctl -p</td>
</tr>
<tr>
<td>V-22417</td>
<td>CCE-4155-8</td>
<td>medium</td>
<td>The system must not send IPv4 Internet Control Message Protocol (ICMP) redirects.</td>
<td>ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination.  These messages contain information from the system's route table possibly revealing portions of the network topology.</td>
<td></td>
<td>Configure the system to not send IPv4 ICMP redirect messages.
Edit /etc/sysctl.conf and add a setting for "net.ipv4.conf.all.send_redirects=0" and "net.ipv4.conf.default.send_redirects=0". 
# sysctl -p</td>
</tr>
<tr>
<td>V-22418</td>
<td>CCE-4320-8</td>
<td>low</td>
<td>The system must log martian packets.</td>
<td>Martian packets are packets containing addresses known by the system to be invalid.  Logging these messages allows the SA to identify misconfigurations or attacks in progress.</td>
<td></td>
<td>Configure the system to log martian packets.
Edit /etc/sysctl.conf and add a setting for "net.ipv4.conf.all.log_martians=1" and "net.ipv4.conf.default.log_martians=1". 

Reload the sysctls.
Procedure:
# sysctl -p</td>
</tr>
<tr>
<td>V-22419</td>
<td>CCE-4265-5</td>
<td>medium</td>
<td>The system must be configured to use TCP syncookies when experiencing a TCP SYN flood.</td>
<td>A TCP SYN flood attack can cause Denial of Service by filling a system's TCP connection table with connections in the SYN_RCVD state.  Syncookies are a mechanism used to only track a connection when a subsequent ACK is received, verifying the initiator is attempting a valid connection and is not a flood source.  This technique does not operate in a fully standards-compliant manner, but is only activated when a flood condition is detected, and allows defense of the system while continuing to service valid requests.</td>
<td></td>
<td>Configure the system to use TCP syncookies when experiencing a TCP SYN flood.
Edit /etc/sysctl.conf and add a setting for "net.ipv4.tcp_syncookies=1". 
# sysctl -p</td>
</tr>
<tr>
<td>V-22421</td>
<td>CCI-001551</td>
<td>medium</td>
<td>The system must not be configured for network bridging.</td>
<td>Some systems have the ability to bridge or switch frames (link-layer forwarding) between multiple interfaces.  This can be useful in a variety of situations but, if enabled when not needed, has the potential to bypass network partitioning and security.</td>
<td></td>
<td>Configure the system to not use bridging.
# rmmod bridge
Edit /etc/modprobe.conf and add a line such as "install bridge /bin/false" to prevent the loading of the bridge module.</td>
</tr>
<tr>
<td>V-22422</td>
<td>CCI-000553</td>
<td>low</td>
<td>All local file systems must employ journaling or another mechanism ensuring file system consistency.</td>
<td>File system journaling, or logging, can allow reconstruction of file system data after a system crash preserving the integrity of data that may have otherwise been lost.  Journaling file systems typically do not require consistency checks upon booting after a crash, which can improve system availability.  Some file systems employ other mechanisms to ensure consistency also satisfying this requirement.</td>
<td></td>
<td>Convert local file systems to use journaling or another mechanism ensuring file system consistency.</td>
</tr>
<tr>
<td>V-22423</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The inetd.conf file, xinetd.conf file, and the xinetd.d directory must be group-owned by root, bin, sys, or system.</td>
<td>Failure to give ownership of sensitive files or utilities to system groups may provide unauthorized users with the potential to access sensitive information or change the system configuration possibly weakening the system's security posture.</td>
<td></td>
<td>Change the group-owner of the xinetd configuration files and directories.

Procedure:
# chgrp -R root /etc/xinetd.conf /etc/xinetd.d</td>
</tr>
<tr>
<td>V-22425</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The xinetd.d directory must have mode 0755 or less permissive.</td>
<td>The Internet service daemon configuration files must be protected as malicious modification could cause Denial of Service or increase the attack surface of the system.</td>
<td></td>
<td>Change the mode of the directory.
# chmod 0755 /etc/xinetd.d</td>
</tr>
<tr>
<td>V-22427</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The services file must be group-owned by root, bin, sys, or system.</td>
<td>Failure to give ownership of system configuration files to root or a system group provides the designated owner and unauthorized users with the potential to change the system configuration possibly weakening the system's security posture.</td>
<td></td>
<td>Change the group-owner of the services file.

Procedure:
# chgrp root /etc/services</td>
</tr>
<tr>
<td>V-22429</td>
<td>CCI-001436</td>
<td>medium</td>
<td>The portmap or rpcbind service must not be running unless needed.</td>
<td>The portmap and rpcbind services increase the attack surface of the system and should only be used when needed.  The portmap or rpcbind services are used by a variety of services using Remote Procedure Calls (RPCs).</td>
<td></td>
<td>Shutdown and disable the portmap service.
# service portmap stop; chkconfig portmap off</td>
</tr>
<tr>
<td>V-22430</td>
<td>CCI-000305</td>
<td>medium</td>
<td>The portmap or rpcbind service must not be installed unless needed.</td>
<td>The portmap and rpcbind services increase the attack surface of the system and should only be used when needed.  The portmap or rpcbind services are used by a variety of services using Remote Procedure Calls (RPCs).</td>
<td></td>
<td>Remove the portmap package.
# rpm -e portmap
or 
# yum remove portmap</td>
</tr>
<tr>
<td>V-22431</td>
<td>CCE-4308-3</td>
<td>medium</td>
<td>The rshd service must not be installed.</td>
<td>The rshd process provides a typically unencrypted, host-authenticated remote access service.  SSH should be used in place of this service.</td>
<td></td>
<td>Remove the rsh-server package.

Procedure:
# rpm -e rsh-server</td>
</tr>
<tr>
<td>V-22432</td>
<td>CCE-3537-8</td>
<td>medium</td>
<td>The rlogind service must not be running.</td>
<td>The rlogind process provides a typically unencrypted, host-authenticated remote access service.  SSH should be used in place of this service.</td>
<td></td>
<td>Remove or disable the rlogin configuration and restart xinetd.
# rm /etc/xinetd.d/rlogin ; service xinetd restart</td>
</tr>
<tr>
<td>V-22433</td>
<td>CCI-000305</td>
<td>medium</td>
<td>The rlogind service must not be installed.</td>
<td>The rlogind process provides a typically unencrypted, host-authenticated remote access service.  SSH should be used in place of this service.</td>
<td></td>
<td>Remove the rsh-server package.

Procedure:
# rpm -e rsh-server</td>
</tr>
<tr>
<td>V-22434</td>
<td>CCI-000305</td>
<td>medium</td>
<td>The rexecd service must not be installed.</td>
<td>The rexecd process provides a typically unencrypted, host-authenticated remote access service.  SSH should be used in place of this service.</td>
<td></td>
<td>Remove the rsh-server package.

Procedure:
# rpm -e rsh-server</td>
</tr>
<tr>
<td>V-22435</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The hosts.lpd (or equivalent) file must be group-owned by root, bin, sys, or system.</td>
<td>Failure to give group-ownership of  the hosts.lpd file to root, bin, sys, or system provides the members of the owning group and possible unauthorized users, with the potential to modify the hosts.lpd file.  Unauthorized modifications could disrupt access to local printers from authorized remote hosts or permit unauthorized remote access to local printers.</td>
<td></td>
<td>Change the group-owner of the printers.conf file.

Procedure:
# chgrp lp /etc/cups/printers.conf</td>
</tr>
<tr>
<td>V-22438</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The aliases file must be group-owned by root, sys, bin, or system.</td>
<td>If the alias file is not group-owned by root or a system group, an unauthorized user may modify the file adding aliases to run malicious code or redirect e-mail.</td>
<td></td>
<td>Change the group-owner of the /etc/aliases file.

Procedure:
for sendmail:
# chgrp root /etc/aliases
# chgrp smmsp /etc/aliases.db

The aliases.db file must be owned by the same system group as sendmail, which is smmsp by default.

for postfix
# chgrp root /etc/postfix/aliases
# chgrp root /etc/postfix/aliases.db</td>
</tr>
<tr>
<td>V-22444</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The ftpusers file must be group-owned by root, bin, sys, or system.</td>
<td>If the ftpusers file is not group-owned by root or a system group, an unauthorized user may modify the file to allow unauthorized accounts to use FTP.</td>
<td></td>
<td>Change the group owner of the ftpusers file.

Procedure:
# chgrp root /etc/ftpusers /etc/vsftpd.ftpusers /etc/vsftpd/ftpusers</td>
</tr>
<tr>
<td>V-22447</td>
<td>CCI-001435</td>
<td>medium</td>
<td>The SNMP service must use only SNMPv3 or its successors.</td>
<td>SNMP Versions 1 and 2 are not considered secure. Without the strong authentication and privacy provided by the SNMP Version 3 User-based Security Model (USM), an attacker or other unauthorized users may gain access to detailed system management information and use the information to launch attacks against the system.</td>
<td></td>
<td>Edit /etc/snmpd.conf and remove references to the "v1", "v2c", "community", or "com2sec". 
Restart the SNMP service.
# service snmpd restart</td>
</tr>
<tr>
<td>V-22451</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The snmpd.conf file must be group-owned by root, bin, sys, or system.</td>
<td>The snmpd.conf file contains authenticators and must be protected from unauthorized access and modification.  If the file is not group-owned by a system group, it may be subject to access and modification from unauthorized users.</td>
<td></td>
<td>Change the group ownership of the SNMP configuration file.

Procedure:
# chgrp root &lt;snmpd.conf&gt;</td>
</tr>
<tr>
<td>V-22453</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The /etc/syslog.conf file must have mode 0640 or less permissive.</td>
<td>Unauthorized users must not be allowed to access or modify the /etc/syslog.conf file.</td>
<td></td>
<td>Change the permissions of the syslog configuration file.
# chmod 0640 /etc/syslog.conf</td>
</tr>
<tr>
<td>V-22455</td>
<td>CCE-4260-6</td>
<td>medium</td>
<td>The system must use a remote syslog server (loghost).</td>
<td>A syslog server (loghost) receives syslog messages from one or more systems.  This data can be used as an authoritative log source in the event a system is compromised and its local logs are suspect.</td>
<td></td>
<td>Edit the syslog configuration file and add an appropriate remote syslog server.</td>
</tr>
<tr>
<td>V-22456</td>
<td>CCI-001436</td>
<td>medium</td>
<td>The SSH client must be configured to only use the SSHv2 protocol.</td>
<td>SSHv1 is not a DoD-approved protocol and has many well-known vulnerability exploits.  Exploits of the SSH client could provide access to the system with the privileges of the user running the client.</td>
<td></td>
<td>Edit the /etc/ssh/ssh_config file and add or edit a "Protocol" configuration line not allowing versions less than 2.</td>
</tr>
<tr>
<td>V-22458</td>
<td>CCE-14491-5</td>
<td>medium</td>
<td>The SSH daemon must be configured to only use FIPS 140-2 approved ciphers.</td>
<td>DoD information systems are required to use FIPS 140-2 approved ciphers.  SSHv2 ciphers meeting this requirement are 3DES and AES.</td>
<td></td>
<td>Edit the SSH daemon configuration and remove any ciphers not starting with  with "3des" or "aes" and remove any ciphers ending with "cbc". If necessary, add a "Ciphers" line. </td>
</tr>
<tr>
<td>V-22460</td>
<td>CCI-001453</td>
<td>medium</td>
<td>The SSH daemon must be configured to only use Message Authentication Codes (MACs) employing FIPS 140-2 approved cryptographic hash algorithms.</td>
<td>DoD information systems are required to use FIPS 140-2 approved cryptographic hash functions.</td>
<td></td>
<td>Edit the SSH daemon configuration and remove any MACs other than "hmac-sha1". If necessary, add a "MACs" line.</td>
</tr>
<tr>
<td>V-22461</td>
<td>CCI-000068</td>
<td>medium</td>
<td>The SSH client must be configured to only use FIPS 140-2 approved ciphers.</td>
<td>DoD information systems are required to use FIPS 140-2 approved ciphers.  SSHv2 ciphers meeting this requirement are 3DES and AES.</td>
<td></td>
<td>Edit the SSH client configuration and remove any ciphers not starting with  with "3des" or "aes" and remove any ciphers ending with "cbc". If necessary, add a "Ciphers" line. </td>
</tr>
<tr>
<td>V-22462</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The SSH client must be configured to not use Cipher-Block Chaining (CBC)-based ciphers.</td>
<td>The (CBC) mode of encryption as implemented in the SSHv2 protocol is vulnerable to chosen-plaintext attacks and must not be used.
</td>
<td></td>
<td>Edit the SSH client configuration and remove any ciphers not starting with  with "3des" or "aes" and remove any ciphers ending with "cbc". If necessary, add a "Ciphers" line.</td>
</tr>
<tr>
<td>V-22463</td>
<td>CCI-001453</td>
<td>medium</td>
<td>The SSH client must be configured to only use Message Authentication Codes (MACs) employing FIPS 140-2 approved cryptographic hash algorithms.</td>
<td>DoD information systems are required to use FIPS 140-2 approved cryptographic hash functions.</td>
<td></td>
<td>Edit the SSH client configuration and remove any MACs other than "hmac-sha1". If necessary, add a "MACs" line.</td>
</tr>
<tr>
<td>V-22470</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The SSH daemon must restrict login ability to specific users and/or groups.</td>
<td>Restricting SSH logins to a limited group of users, such as system administrators, prevents password-guessing and other SSH attacks from reaching system accounts and other accounts not authorized for SSH access.</td>
<td></td>
<td>Edit the SSH daemon configuration and add an "AllowGroups" or "AllowUsers" directive specifying the groups and users allowed to have access.

Alternatively, modify the /etc/pam.d/sshd file to include the line 

account required pam_access.so accessfile=&lt;path to access.conf for sshd&gt;

If the "accessfile" option is not specified the default "access.conf" file will be used. The "access.conf" file must contain the user restriction definitions.</td>
</tr>
<tr>
<td>V-22471</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The SSH public host key files must have mode 0644 or less permissive.</td>
<td>If a public host key file is modified by an unauthorized user, the SSH service may be compromised.</td>
<td></td>
<td>Change the permissions for the SSH public host key files.
# chmod 0644 /etc/ssh/*key.pub</td>
</tr>
<tr>
<td>V-22472</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The SSH private host key files must have mode 0600 or less permissive.</td>
<td>If an unauthorized user obtains the private SSH host key file, the host could be impersonated.</td>
<td></td>
<td>Change the permissions for the SSH private host key files.
# chmod 0600 /etc/ssh/*key</td>
</tr>
<tr>
<td>V-22473</td>
<td>CCI-000366</td>
<td>low</td>
<td>The SSH daemon must not permit GSSAPI authentication unless needed.</td>
<td>GSSAPI authentication is used to provide additional authentication mechanisms to applications. Allowing GSSAPI authentication through SSH exposes the systems GSSAPI to remote hosts, increasing the attack surface of the system.  GSSAPI authentication must be disabled unless needed.</td>
<td></td>
<td>Edit the SSH daemon configuration and set (add if necessary) a "GSSAPIAuthentication" directive set to "no".</td>
</tr>
<tr>
<td>V-22474</td>
<td>CCI-000366</td>
<td>low</td>
<td>The SSH client must not permit GSSAPI authentication unless needed.</td>
<td>GSSAPI authentication is used to provide additional authentication mechanisms to applications. Allowing GSSAPI authentication through SSH exposes the systems GSSAPI to remote hosts, increasing the attack surface of the system.  GSSAPI authentication must be disabled unless needed.</td>
<td></td>
<td>Edit the SSH client configuration and set the GSSAPIAuthentication" directive set to "no". </td>
</tr>
<tr>
<td>V-22475</td>
<td>CCI-000366</td>
<td>low</td>
<td>The SSH daemon must not permit Kerberos authentication unless needed.</td>
<td>Kerberos authentication for SSH is often implemented using GSSAPI.  If Kerberos is enabled through SSH, the SSH daemon provides a means of access to the system's Kerberos implementation.  Vulnerabilities in the system's Kerberos implementation may then be subject to exploitation.  To reduce the attack surface of the system, the Kerberos authentication mechanism within SSH must be disabled for systems not using this capability.
</td>
<td></td>
<td>Edit the SSH daemon configuration and set (add if necessary) the "KerberosAuthentication" directive set to "no".</td>
</tr>
<tr>
<td>V-22485</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The SSH daemon must perform strict mode checking of home directory configuration files.</td>
<td>If other users have access to modify user-specific SSH configuration files, they may be able to log into the system as another user.</td>
<td></td>
<td>Edit the SSH daemon configuration and add or edit the "StrictModes" setting value to "yes".</td>
</tr>
<tr>
<td>V-22486</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The SSH daemon must use privilege separation.</td>
<td>SSH daemon privilege separation causes the SSH process to drop root privileges when not needed, which would decrease the impact of software vulnerabilities in the unprivileged section.</td>
<td></td>
<td>Edit the SSH daemon configuration and add or edit the "UsePrivilegeSeparation" setting value to "yes".</td>
</tr>
<tr>
<td>V-22487</td>
<td>CCE-4370-3</td>
<td>medium</td>
<td>The SSH daemon must not allow rhosts RSA authentication.</td>
<td>If SSH permits rhosts RSA authentication, a user may be able to log in based on the keys of the host originating the request and not any user-specific authentication.</td>
<td></td>
<td>Edit the SSH daemon configuration and add or edit the "RhostsRSAAuthentication" setting value to "no".</td>
</tr>
<tr>
<td>V-22488</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The SSH daemon must not allow compression or must only allow compression after successful authentication.</td>
<td>If compression is allowed in an SSH connection prior to authentication, vulnerabilities in the compression software could result in compromise of the system from an unauthenticated connection, potentially with root privileges.</td>
<td></td>
<td>Edit the SSH daemon configuration and add or edit the "Compression" setting value to "no" or "delayed".</td>
</tr>
<tr>
<td>V-22489</td>
<td>CCE-4431-3</td>
<td>medium</td>
<td>The SSH daemon must be configured with the Department of Defense (DoD) logon banner.</td>
<td>Failure to display the DoD logon banner prior to a logon attempt will negate legal proceedings resulting from unauthorized access to system resources.

The SSH service must be configured to display the DoD logon warning banner either through the SSH configuration or a wrapper program such as TCP_WRAPPERS.

The SSH daemon may also be used to provide SFTP service.  The warning banner configuration for SSH will apply to SFTP.</td>
<td></td>
<td>Edit /etc/issue and the DoD login banner.

DoD Login Banners:

You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only.

By using this IS (which includes any device attached to this IS), you consent to the following conditions:

-The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations.

-At any time, the USG may inspect and seize data stored on this IS.

-Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose.

-This IS includes security measures (e.g., authentication and access controls) to protect USG interests- -not for your personal benefit or privacy.

-Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details.


Find the location of the banner file for sshd and examine the content:

# grep -i banner /etc/ssh/sshd_config | grep -v '^#'
# cat

Edit the SSH daemon configuration and add or edit a "Banner" setting referencing a file containing a logon warning banner.</td>
</tr>
<tr>
<td>V-22491</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The system must not have IP forwarding for IPv6 enabled, unless the system is an IPv6 router.</td>
<td>If the system is configured for IP forwarding and is not a designated router, it could be used to bypass network security by providing a path for communication not filtered by network devices.</td>
<td></td>
<td>Disable IPv6 forwarding.

Edit /etc/sysctl.conf and add a setting for "net.ipv6.conf.all.forwarding=0" and "net.ipv6.conf.default.forwarding=0".

Reload the sysctls.
Procedure:
# sysctl -p</td>
</tr>
<tr>
<td>V-22492</td>
<td>CCI-000225</td>
<td>medium</td>
<td>The Network File System (NFS) export configuration file must be group-owned by root, bin, sys, or system.</td>
<td>Failure to give group-ownership of the NFS export configuration file to root or a system group provides the designated group-owner and possible unauthorized users with the potential to change system configuration which could weaken the system's security posture.</td>
<td></td>
<td>Change the group ownership of the NFS export configuration file.

Procedure:
# chgrp root /etc/exports</td>
</tr>
<tr>
<td>V-22496</td>
<td>CCI-000225</td>
<td>medium</td>
<td>All Network File System (NFS) exported system files and system directories must be group-owned by root, bin, sys, or system.</td>
<td>Failure to give group-ownership of sensitive files or directories to root provides the members of the owning group with the potential to access sensitive information or change system configuration which could weaken the system's security posture.</td>
<td></td>
<td>Change the group owner of the export directory.
# chgrp root &lt;export&gt;</td>
</tr>
<tr>
<td>V-22499</td>
<td>CCI-000366</td>
<td>medium</td>
<td>Samba must be configured to use an authentication mechanism other than "share."</td>
<td>Samba share authentication does not provide for individual user identification and must not be used.</td>
<td></td>
<td>Edit the "/etc/samba/smb.conf" file and change the "security" setting to "user" or another valid setting other than "share".</td>
</tr>
<tr>
<td>V-22500</td>
<td>CCI-000366</td>
<td>medium</td>
<td>Samba must be configured to use encrypted passwords.</td>
<td>Samba must be configured to protect authenticators.  If Samba passwords are not encrypted for storage, plain-text user passwords may be read by those with access to the Samba password file.</td>
<td></td>
<td>Edit the "/etc/samba/smb.conf" file and change the "encrypt passwords" setting to "yes".</td>
</tr>
<tr>
<td>V-22501</td>
<td>CCI-000366</td>
<td>medium</td>
<td>Samba must be configured to not allow guest access to shares.</td>
<td>Guest access to shares permits anonymous access and is not permitted.</td>
<td></td>
<td>Edit the "/etc/samba/smb.conf" file and change the "guest ok" setting to "no".</td>
</tr>
<tr>
<td>V-22511</td>
<td>CCE-14132-5</td>
<td>medium</td>
<td>The Stream Control Transmission Protocol (SCTP) must be disabled unless required.</td>
<td>The Stream Control Transmission Protocol (SCTP) is an Internet Engineering Task Force (IETF)-standardized transport layer protocol.  This protocol is not yet widely used.  Binding this protocol to the network stack increases the attack surface of the host.  Unprivileged local processes may be able to cause the system to dynamically load a protocol handler by opening a socket using the protocol.</td>
<td></td>
<td>Prevent the SCTP protocol handler for dynamic loading.
# echo "install sctp /bin/true" &gt;&gt; /etc/modprobe.conf</td>
</tr>
<tr>
<td>V-22514</td>
<td>CCE-14268-7</td>
<td>medium</td>
<td>The Datagram Congestion Control Protocol (DCCP) must be disabled unless required.</td>
<td>The DCCP is a proposed transport layer protocol.  This protocol is not yet widely used.  Binding this protocol to the network stack increases the attack surface of the host.  Unprivileged local processes may be able to cause the system to dynamically load a protocol handler by opening a socket using the protocol.</td>
<td></td>
<td>Prevent the DCCP protocol handler for dynamic loading.
# echo "install dccp /bin/true" &gt;&gt; /etc/modprobe.conf
# echo "install dccp_ipv4 /bin/true" &gt;&gt; /etc/modprobe.conf
# echo "install dccp_ipv6 /bin/true" &gt;&gt; /etc/modprobe.conf</td>
</tr>
<tr>
<td>V-22524</td>
<td>CCI-000382</td>
<td>medium</td>
<td>The AppleTalk protocol must be disabled or not installed.</td>
<td>The AppleTalk suite of protocols is no longer in common use.  Binding this protocol to the network stack increases the attack surface of the host.  Unprivileged local processes may be able to cause the system to dynamically load a protocol handler by opening a socket using the protocol.</td>
<td></td>
<td>Prevent the AppleTalk protocol handler for dynamic loading.
# echo "install appletalk /bin/true" &gt;&gt; /etc/modprobe.conf</td>
</tr>
<tr>
<td>V-22530</td>
<td>CCE-14027-7</td>
<td>medium</td>
<td>The Reliable Datagram Sockets (RDS) protocol must be disabled or not installed unless required.</td>
<td>The RDS protocol is a relatively new protocol developed by Oracle for communication between the nodes of a cluster.  Binding this protocol to the network stack increases the attack surface of the host.  Unprivileged local processes may be able to cause the system to dynamically load a protocol handler by opening a socket using the protocol.</td>
<td></td>
<td>Prevent the RDS protocol handler for dynamic loading.
# echo "install rds /bin/true" &gt;&gt; /etc/modprobe.conf</td>
</tr>
<tr>
<td>V-22533</td>
<td>CCE-14911-2</td>
<td>medium</td>
<td>The Transparent Inter-Process Communication (TIPC) protocol must be disabled or uninstalled.</td>
<td>The TIPC protocol is a relatively new cluster communications protocol developed by Ericsson.  Binding this protocol to the network stack increases the attack surface of the host.   Unprivileged local processes may be able to cause the system to dynamically load a protocol handler by opening a socket using the protocol.</td>
<td></td>
<td>Prevent the TIPC protocol handler for dynamic loading.
# echo "install tipc /bin/true" &gt;&gt; /etc/modprobe.conf</td>
</tr>
<tr>
<td>V-22539</td>
<td>CCI-001551</td>
<td>medium</td>
<td>The Bluetooth protocol handler must be disabled or not installed.</td>
<td>Bluetooth is a Personal Area Network (PAN) technology.  Binding this protocol to the network stack increases the attack surface of the host.   Unprivileged local processes may be able to cause the kernel to dynamically load a protocol handler by opening a socket using the protocol.</td>
<td></td>
<td>Prevent the Bluetooth protocol handler for dynamic loading.
# echo "install bluetooth /bin/true" &gt;&gt; /etc/modprobe.conf</td>
</tr>
<tr>
<td>V-22541</td>
<td>CCI-001551</td>
<td>medium</td>
<td>The IPv6 protocol handler must not be bound to the network stack unless needed.</td>
<td>IPv6 is the next version of the Internet protocol.  Binding this protocol to the network stack increases the attack surface of the host.</td>
<td></td>
<td>Remove the capability to use IPv6 protocol handler.

Procedure:
Edit /etc/sysconfig/network and change
NETWORKING_IPV6=yes
to
NETWORKING_IPV6=no

Edit /etc/modprobe.conf and add these lines (if they are not in it):
alias net-pf-10 off
alias ipv6 off

Stop the ipv6tables service by typing:
service ip6tables stop

Disable the ipv6tables service by typing:
chkconfig ip6tables off

Remove the ipv6 kernel module
# rmmod ipv6

Reboot</td>
</tr>
<tr>
<td>V-22542</td>
<td>CCE-3562-6</td>
<td>medium</td>
<td>The IPv6 protocol handler must be prevented from dynamic loading unless needed.</td>
<td>IPv6 is the next generation of the Internet protocol.  Binding this protocol to the network stack increases the attack surface of the host.   Unprivileged local processes may be able to cause the system to dynamically load a protocol handler by opening a socket using the protocol.</td>
<td></td>
<td>Prevent the IPv6 protocol handler for dynamic loading.
# echo "install ipv6 /bin/true" &gt;&gt; /etc/modprobe.conf</td>
</tr>
<tr>
<td>V-22546</td>
<td>CCI-001551</td>
<td>medium</td>
<td>The system must not have Teredo enabled.</td>
<td>Teredo is an IPv6 transition mechanism involving tunneling IPv6 packets encapsulated in IPv4 packets. Unauthorized tunneling may circumvent network security.</td>
<td></td>
<td>Edit startup scripts to prevent the service from running on startup.</td>
</tr>
<tr>
<td>V-22549</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The DHCP client must not send dynamic DNS updates.</td>
<td>Dynamic DNS updates transmit unencrypted information about a system including its name and address and should not be used unless needed.</td>
<td></td>
<td>Edit or add the "/etc/dhclient.conf" file and add or edit the "do-forward-updates" setting to false.

Procedure:
# echo "do-forward-updates false;" &gt;&gt; /etc/dhclient.conf</td>
</tr>
<tr>
<td>V-22550</td>
<td>CCI-001551</td>
<td>medium</td>
<td>The system must ignore IPv6 ICMP redirect messages.</td>
<td>ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.</td>
<td></td>
<td>Configure the system to ignore IPv6 ICMP redirect messages.
Edit "/etc/sysctl.conf" and add a settings for "net.ipv6.conf.default.accept_redirects=0" and "net.ipv6.conf.all.accept_redirects=0". 
Restart the system for the setting to take effect.</td>
</tr>
<tr>
<td>V-22557</td>
<td>CCI-000185</td>
<td>medium</td>
<td>If the system is using LDAP for authentication or account information, the LDAP TLS connection must require the server provide a certificate with a valid trust path to a trusted CA.</td>
<td>The NSS LDAP service provides user mappings which are a vital component of system security.  Communication between an LDAP server and a host using LDAP for NSS require authentication.</td>
<td></td>
<td>Edit "/etc/ldap.conf" and add or set the "tls_checkpeer" setting to "yes".</td>
</tr>
<tr>
<td>V-22558</td>
<td>CCI-000185</td>
<td>medium</td>
<td>If the system is using LDAP for authentication or account information, the system must verify the LDAP server's certificate has not been revoked.</td>
<td>LDAP can be used to provide user authentication and account information, which are vital to system security. Communication between an LDAP server and a host using LDAP requires authentication.</td>
<td></td>
<td>Edit "/etc/ldap.conf" and add or set the "tls_crlcheck" setting to "all".</td>
</tr>
<tr>
<td>V-22559</td>
<td>CCI-000225</td>
<td>medium</td>
<td>If the system is using LDAP for authentication or account information the /etc/ldap.conf (or equivalent) file must have mode 0644 or less permissive.</td>
<td>LDAP can be used to provide user authentication and account information, which are vital to system security.  The LDAP client configuration must be protected from unauthorized modification.</td>
<td></td>
<td>Change the permissions of the file.
# chmod 0644 /etc/ldap.conf</td>
</tr>
<tr>
<td>V-22560</td>
<td>CCI-000225</td>
<td>medium</td>
<td>If the system is using LDAP for authentication or account information, the /etc/ldap.conf (or equivalent) file must be owned by root.</td>
<td>LDAP can be used to provide user authentication and account information, which are vital to system security.  The LDAP client configuration must be protected from unauthorized modification.</td>
<td></td>
<td>Change the owner of the file.
# chown root /etc/ldap.conf</td>
</tr>
<tr>
<td>V-22561</td>
<td>CCI-000225</td>
<td>medium</td>
<td>If the system is using LDAP for authentication or account information, the /etc/ldap.conf (or equivalent) file must be group-owned by root, bin, sys, or system.</td>
<td>LDAP can be used to provide user authentication and account information, which are vital to system security.  The LDAP client configuration must be protected from unauthorized modification.</td>
<td></td>
<td>Change the group owner of the file to root, bin, sys, or system.

Procedure:
# chgrp root /etc/ldap.conf</td>
</tr>
<tr>
<td>V-22563</td>
<td>CCI-000225</td>
<td>medium</td>
<td>If the system is using LDAP for authentication or account information, the TLS certificate authority file and/or directory (as appropriate) must be owned by root.</td>
<td>LDAP can be used to provide user authentication and account information, which are vital to system security.  The LDAP client configuration must be protected from unauthorized modification.</td>
<td></td>
<td>Change the ownership of the file or directory.
# chown root &lt;certpath&gt;</td>
</tr>
<tr>
<td>V-22564</td>
<td>CCI-000225</td>
<td>medium</td>
<td>If the system is using LDAP for authentication or account information, the TLS certificate authority file and/or directory (as appropriate) must be group-owned by root, bin, sys, or system.</td>
<td>LDAP can be used to provide user authentication and account information, which are vital to system security.  The LDAP client configuration must be protected from unauthorized modification</td>
<td></td>
<td>Change the group ownership of the file or directory.
# chgrp root &lt;certpath&gt;</td>
</tr>
<tr>
<td>V-22565</td>
<td>CCI-000225</td>
<td>medium</td>
<td>If the system is using LDAP for authentication or account information, the TLS certificate authority file and/or directory (as appropriate) must have mode 0644 (0755 for directories) or less permissive.</td>
<td>LDAP can be used to provide user authentication and account information, which are vital to system security.  The LDAP client configuration must be protected from unauthorized modification.</td>
<td></td>
<td>Change the mode of the file or directory.

File Procedure:
# chmod 0644 &lt;certpath&gt; 

Directory Procedure:
# chmod 0755 &lt;certpath&gt;</td>
</tr>
<tr>
<td>V-22567</td>
<td>CCI-000225</td>
<td>medium</td>
<td>For systems using NSS LDAP, the TLS certificate file must be owned by root.</td>
<td>The NSS LDAP service provides user mappings which are a vital component of system security.  Its configuration must be protected from unauthorized modification.</td>
<td></td>
<td>Change the ownership of the file.
# chown root &lt;certpath&gt;</td>
</tr>
<tr>
<td>V-22568</td>
<td>CCI-000225</td>
<td>medium</td>
<td>If the system is using LDAP for authentication or account information, the LDAP TLS certificate file must be group-owned by root, bin, sys, or system.</td>
<td>LDAP can be used to provide user authentication and account information, which are vital to system security.  The LDAP client configuration must be protected from unauthorized modification.</td>
<td></td>
<td>Change the group ownership of the file.

Procedure:
# chgrp root &lt;certpath&gt;</td>
</tr>
<tr>
<td>V-22569</td>
<td>CCI-000225</td>
<td>medium</td>
<td>If the system is using LDAP for authentication or account information, the LDAP TLS certificate file must have mode 0644 or less permissive.</td>
<td>LDAP can be used to provide user authentication and account information, which are vital to system security.  The LDAP client configuration must be protected from unauthorized modification.</td>
<td></td>
<td>Change the mode of the file.
# chmod 0644 &lt;certpath&gt;</td>
</tr>
<tr>
<td>V-22571</td>
<td>CCI-000225</td>
<td>medium</td>
<td>If the system is using LDAP for authentication or account information, the LDAP TLS key file must be owned by root.</td>
<td>LDAP can be used to provide user authentication and account information, which are vital to system security.  The LDAP client configuration must be protected from unauthorized modification.</td>
<td></td>
<td>Change the ownership of the file.
# chown root &lt;keypath&gt;</td>
</tr>
<tr>
<td>V-22572</td>
<td>CCI-000225</td>
<td>medium</td>
<td>If the system is using LDAP for authentication or account information, the LDAP TLS key file must be group-owned by root, bin, or sys.</td>
<td>LDAP can be used to provide user authentication and account information, which are vital to system security.  The LDAP client configuration must be protected from unauthorized modification.</td>
<td></td>
<td>Change the group ownership of the file.
# chgrp root &lt;keypath&gt;</td>
</tr>
<tr>
<td>V-22573</td>
<td>CCI-000225</td>
<td>medium</td>
<td>If the system is using LDAP for authentication or account information, the LDAP TLS key file must have mode 0600 or less permissive.</td>
<td>LDAP can be used to provide user authentication and account information, which are vital to system security.  The LDAP client configuration must be protected from unauthorized modification.

Note:  Depending on the particular implementation, group and other read permission may be necessary for unprivileged users to successfully resolve account information using LDAP.  This will still be a finding, as these permissions provide users with access to system authenticators.</td>
<td></td>
<td>Change the mode of the file.
# chmod 0600 &lt;keypath&gt;</td>
</tr>
<tr>
<td>V-22576</td>
<td>CCI-000366</td>
<td>low</td>
<td>The system must use available memory address randomization techniques.</td>
<td>Successful exploitation of buffer overflow vulnerabilities relies in some measure to having a predictable address structure of the executing program. Address randomization techniques reduce the probability of a successful exploit.</td>
<td></td>
<td>Edit the kernel boot parameters, or "/etc/sysctl.conf", and set exec-shield to "1". Reboot the system.</td>
</tr>
<tr>
<td>V-22577</td>
<td>CCE-4072-5</td>
<td>low</td>
<td>Automated file system mounting tools must not be enabled unless needed.</td>
<td>Automated file system mounting tools may provide unprivileged users with the ability to access local media and network shares.  If this access is not necessary for the systems operation, it must be disabled to reduce the risk of unauthorized access to these resources.</td>
<td></td>
<td>Stop and disable the autofs service.
# service autofs stop
# chkconfig autofs off</td>
</tr>
<tr>
<td>V-22579</td>
<td>CCI-000366</td>
<td>low</td>
<td>The system must have USB Mass Storage disabled unless needed.</td>
<td>USB is a common computer peripheral interface. USB devices may include storage devices with the potential to install malicious software on a system or exfiltrate data</td>
<td></td>
<td>Prevent the usb-storage module from loading.
# echo 'install usb-storage /bin/true' &gt;&gt; /etc/modprobe.conf</td>
</tr>
<tr>
<td>V-22580</td>
<td>CCI-000366</td>
<td>low</td>
<td>The system must have IEEE 1394 (Firewire) disabled unless needed.</td>
<td>Firewire is a common computer peripheral interface. Firewire devices may include storage devices with the potential to install malicious software on a system or exfiltrate data.</td>
<td></td>
<td>Prevent the system from loading the firewire module.
# echo 'install ieee1394 /bin/true' &gt;&gt; /etc/modprobe.conf</td>
</tr>
<tr>
<td>V-22582</td>
<td>CCE-4189-7</td>
<td>medium</td>
<td>The system must employ a local firewall.</td>
<td>A local firewall protects the system from exposing unnecessary or undocumented network services to the local enclave.  If a system within the enclave is compromised, firewall protection on an individual system continues to protect it from attack.</td>
<td></td>
<td>Enable the system's local firewall.
# chkconfig iptables on
# service iptables start</td>
</tr>
<tr>
<td>V-22584</td>
<td>CCE-3977-6</td>
<td>low</td>
<td>The system must use a Linux Security Module configured to limit the privileges of system services.</td>
<td>Linux Security Modules such as SELinux and AppArmor can be used to provide protection from software exploits by explicitly defining the privileges permitted to each software package.</td>
<td></td>
<td>Enable one of the SELinux prolicies.
Edit /etc/sysconfig/selinux and set the value of the SELINUX option to "enforcing" and SELINUXTYPE to "targeted" or "strict".
Restart the system.</td>
</tr>
<tr>
<td>V-22586</td>
<td>CCE-4144-2</td>
<td>medium</td>
<td>The system's boot loader configuration files must be owned by root.</td>
<td>The system's boot loader configuration files are critical to the integrity of the system and must be protected.  Unauthorized modification of these files resulting from improper ownership could compromise the system's boot loader configuration.</td>
<td></td>
<td>Change the ownership of the file.
# chown root /boot/grub/grub.conf</td>
</tr>
<tr>
<td>V-22587</td>
<td>CCE-4197-0</td>
<td>medium</td>
<td>The system's boot loader configuration file(s) must be group-owned by root, bin, sys, or system.</td>
<td>The system's boot loader configuration files are critical to the integrity of the system and must be protected.  Unauthorized modifications resulting from improper group ownership may compromise the boot loader configuration.</td>
<td></td>
<td>Change the group ownership of the file.
# chgrp root /boot/grub/grub.conf</td>
</tr>
<tr>
<td>V-22598</td>
<td>CCE-15026-8</td>
<td>low</td>
<td>Auditing must be enabled at boot by setting a kernel parameter.</td>
<td>If auditing is enabled late in the boot process, the actions of startup scripts may not be audited.  Some audit systems also maintain state information only available if auditing is enabled before a given process is created.</td>
<td></td>
<td>Edit the grub bootloader file /boot/grub/grub.conf or /boot/grub/menu.lst by appending the "audit=1" parameter to the kernel boot line.
Reboot the system for the change to take effect.</td>
</tr>
<tr>
<td>V-22665</td>
<td>CCI-000366</td>
<td>medium</td>
<td>The system must not be running any routing protocol daemons, unless the system is a router.</td>
<td>Routing protocol daemons are typically used on routers to exchange network topology information with other routers.  If this software is used when not required, system network information may be unnecessarily transmitted across the network.</td>
<td></td>
<td>Disable any routing protocol daemons.</td>
</tr>
<tr>
<td>V-22702</td>
<td>CCI-000162</td>
<td>medium</td>
<td>System audit logs must be group-owned by root, bin, sys, or system.</td>
<td>Sensitive system and user information could provide a malicious user with enough information to penetrate further into the system.</td>
<td></td>
<td>Change the group ownership of the audit log file(s).

Procedure:
# chgrp root &lt;audit log file&gt;</td>
</tr>
<tr>
<td>V-23736</td>
<td>CCI-001208</td>
<td>low</td>
<td>The system must use a separate file system for /var.</td>
<td>The use of separate file systems for different paths can protect the system from failures resulting from a file system becoming full or failing.</td>
<td></td>
<td>Migrate the /var path onto a separate file system.</td>
</tr>
<tr>
<td>V-23738</td>
<td>CCI-001208</td>
<td>low</td>
<td>The system must use a separate file system for the system audit data path.</td>
<td>The use of separate file systems for different paths can protect the system from failures resulting from a file system becoming full or failing.</td>
<td></td>
<td>Migrate the /var/log/audit path onto a separate filesystem.</td>
</tr>
<tr>
<td>V-23739</td>
<td>CCI-001208</td>
<td>low</td>
<td>The system must use a separate file system for /tmp (or equivalent).</td>
<td>The use of separate file systems for different paths can protect the system from failures resulting from a file system becoming full or failing.</td>
<td></td>
<td>Migrate the /tmp path onto a separate file system.</td>
</tr>
<tr>
<td>V-23741</td>
<td>CCI-000366</td>
<td>medium</td>
<td>TCP backlog queue sizes must be set appropriately.</td>
<td>To provide some mitigation to TCP Denial of Service attacks, the TCP backlog queue sizes must be set to at least 1280 or in accordance with product-specific guidelines.</td>
<td></td>
<td>Edit /etc/sysctl.conf and add a setting for "net.ipv4.tcp_max_syn_backlog=1280".

Procedure:
# sysctl -p</td>
</tr>
<tr>
<td>V-23952</td>
<td>CCI-001305</td>
<td>medium</td>
<td>Mail relaying must be restricted.</td>
<td>If unrestricted mail relaying is permitted, unauthorized senders could use this host as a mail relay for the purpose of sending SPAM or other unauthorized activity.</td>
<td></td>
<td>If the system uses sendmail, edit the sendmail.mc file and remove the "promiscuous_relay" configuration. Rebuild the sendmail.cf file from the modified sendmail.mc and restart the service. If the system does not need to receive mail from external hosts, add one or more DaemonPortOptions lines referencing system loopback addresses (such as "O DaemonPortOptions=Addr=127.0.0.1,Port=smtp,Name=MTA") and remove lines containing non-loopback addresses. Restart the service.

If the system uses Postfix, edit the main.cf file and add or edit the "smtpd_client_restrictions" line to have contents "permit mynetworks, reject" or a similarly restrictive rule. If the system does not need to receive mail from external hosts, add or edit the "inet_interfaces" line to have contents "loopback-only" or a set of loopback addresses for the system. Restart the service.

If the system is using other SMTP software, consult the software's documentation for procedures to restrict mail relaying.</td>
</tr>
<tr>
<td>V-23953</td>
<td>CCI-000305</td>
<td>medium</td>
<td>The 'ldd' command must be disabled unless it protects against the execution of untrusted files.</td>
<td>The 'ldd' command provides a list of dependent libraries needed by a given binary, which is useful for troubleshooting software.  Instead of parsing the binary file, some 'ldd' implementations invoke the program with a special environment variable set, which causes the system dynamic linker to display the list of libraries.  Specially crafted binaries can specify an alternate dynamic linker which may cause a program to be executed instead of examined.  If the program is from an untrusted source, such as in a user home directory, or a file suspected of involvement in a system compromise, unauthorized software may be executed with the rights of the user running 'ldd'.  

Some 'ldd' implementations include protections that prevent the execution of untrusted files.  If such protections exist, this requirement is not applicable.

An acceptable method of disabling 'ldd' is changing its mode to 0000.  The SA may conduct troubleshooting by temporarily changing the mode to allow execution and running the 'ldd' command as an unprivileged user upon trusted system binaries.</td>
<td></td>
<td>Remove the execute permissions from the 'ldd' executable.

Procedure:
# chmod a-x /usr/bin/ldd</td>
</tr>
<tr>
<td>V-24357</td>
<td>CCI-000136</td>
<td>low</td>
<td>The system must be configured to send audit records to a remote audit server.</td>
<td>Audit records contain evidence that can be used in the investigation of compromised systems. To prevent this evidence from compromise, it must be sent to a separate system continuously. Methods for sending audit records include, but are not limited to, system audit tools used to send logs directly to another host or through the system's syslog service to another host.
</td>
<td></td>
<td>Configure the system to send audit records to a remote server. 

Procedure:
These instructions assume a known remote audit server is available to this system. 
Modify /etc/syslog.conf to contain a line sending all audit records to a remote audit server. The server is specified by placing an "@" before the DNS name or IP address in the line. 

*.* @&lt;remote audit server&gt;

Edit the "active" line in /etc/audisp/plugins.d/syslog.conf so it shows "active = yes".

Restart audit and syslog:
# service auditd restart
# service syslog restart</td>
</tr>
<tr>
<td>V-24384</td>
<td>CCI-000196</td>
<td>medium</td>
<td>If the system is using LDAP for authentication or account information, the /etc/ldap.conf file (or equivalent) must not contain passwords.</td>
<td>The authentication of automated LDAP connections between systems must not use passwords since more secure methods are available, such as PKI and Kerberos. Additionally, the storage of unencrypted passwords on the system is not permitted.</td>
<td></td>
<td>Edit the "/etc/ldap.conf" file to use anonymous binding by removing the "bindpw" option.</td>
</tr>
<tr>
<td>V-24624</td>
<td>CCI-000213</td>
<td>medium</td>
<td>The system boot loader must protect passwords using an MD5 or stronger cryptographic hash.</td>
<td>If system boot loader passwords are compromised, users with console access to the system may be able to alter the system boot configuration or boot the system into single user or maintenance mode, which could result in Denial of Service or unauthorized privileged access to the system.</td>
<td></td>
<td>Consult vendor documentation for procedures concerning the system's boot loader.  Configure the boot loader to hash boot loader passwords using MD5 or a stronger hash.</td>
</tr>
<tr>
<td>V-27275</td>
<td>CCI-000012</td>
<td>medium</td>
<td>The system must not have the unnecessary "news" account.</td>
<td>Accounts that provide no operational purpose provide additional opportunities for system compromise. Unnecessary accounts include user accounts for individuals not requiring access to the system and application accounts for applications not installed on the system.</td>
<td></td>
<td>Remove the "news" account from the /etc/passwd file before connecting a system to the network.</td>
</tr>
<tr>
<td>V-27276</td>
<td>CCI-000012</td>
<td>medium</td>
<td>The system must not have the unnecessary "gopher" account.</td>
<td>Accounts that provide no operational purpose provide additional opportunities for system compromise. Unnecessary accounts include user accounts for individuals not requiring access to the system and application accounts for applications not installed on the system.</td>
<td></td>
<td>Remove the "gopher" account from the /etc/passwd file before connecting a system to the network.</td>
</tr>
<tr>
<td>V-27279</td>
<td>CCI-000012</td>
<td>medium</td>
<td>The system must not have the unnecessary "ftp" account.</td>
<td>Accounts that provide no operational purpose provide additional opportunities for system compromise. Unnecessary accounts include user accounts for individuals not requiring access to the system and application accounts for applications not installed on the system.</td>
<td></td>
<td>Remove the "ftp" account from the /etc/passwd file before connecting a system to the network.</td>
</tr>
<tr>
<td>V-27283</td>
<td>CCI-000057</td>
<td>medium</td>
<td>The graphical desktop environment must set the idle timeout to no more than 15 minutes.</td>
<td>If graphical desktop sessions do not lock the session after 15 minutes of inactivity, requiring re-authentication to resume operations, the system or individual data could be compromised by an alert intruder who could exploit the oversight. This requirement applies to graphical desktop environments provided by the system to locally attached displays and input devices as well as to graphical desktop environments provided to remote systems, including thin clients.</td>
<td></td>
<td>For the Gnome screen saver, set idle_delay to 15.

Procedure:
# gconftool-2 --direct --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory --type int --set /apps/gnome-screensaver/idle_delay 15</td>
</tr>
<tr>
<td>V-27284</td>
<td>CCI-000057</td>
<td>medium</td>
<td>Graphical desktop environments provided by the system must have automatic lock enabled.</td>
<td>If graphical desktop sessions do not lock the session after 15 minutes of inactivity, requiring re-authentication to resume operations, the system or individual data could be compromised by an alert intruder who could exploit the oversight. This requirement applies to graphical desktop environments provided by the system to locally attached displays and input devices as well as to graphical desktop environments provided to remote systems, including thin clients.</td>
<td></td>
<td>For the Gnome screen saver, set the lock_enabled flag.

Procedure:
# gconftool-2 --direct --config-source xml:readwrite:/etc/gconf/gconf.xml.mandatory --type bool --set /apps/gnome-screensaver/lock_enabled true</td>
</tr>
<tr>
<td>V-29236</td>
<td>CCI-000192</td>
<td>medium</td>
<td>The audit system must be configured to audit failed attempts to access files and programs.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>Edit the audit.rules file and add the following line(s) to enable auditing of failed attempts to access files and programs:

either:
-a exit,always -F arch=&lt;ARCH&gt; -S open -F success=0

or both:
-a exit,always -F arch=&lt;ARCH&gt; -S open -F exit=-EPERM
-a exit,always -F arch=&lt;ARCH&gt; -S open -F exit=-EACCES

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29237</td>
<td>CCI-000192</td>
<td>medium</td>
<td>The audit system must be configured to audit failed attempts to access files and programs.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>Edit the audit.rules file and add the following line(s) to enable auditing of failed attempts to access files and programs:

either:
-a exit,always -F arch=&lt;ARCH&gt; -S openat -F success=0

or both:
-a exit,always -F arch=&lt;ARCH&gt; -S openat -F exit=-EPERM
-a exit,always -F arch=&lt;ARCH&gt; -S openat -F exit=-EACCES

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29238</td>
<td>CCI-000192</td>
<td>medium</td>
<td>The audit system must be configured to audit failed attempts to access files and programs.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>Edit the audit.rules file and add the following line(s) to enable auditing of failed attempts to access files and programs:

either:
-a exit,always -F arch=&lt;ARCH&gt; -S truncate -F success=0

or both:
-a exit,always -F arch=&lt;ARCH&gt; -S truncate -F exit=-EPERM
-a exit,always -F arch=&lt;ARCH&gt; -S truncate -F exit=-EACCES

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29239</td>
<td>CCI-000192</td>
<td>medium</td>
<td>The audit system must be configured to audit failed attempts to access files and programs.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>Edit the audit.rules file and add the following line(s) to enable auditing of failed attempts to access files and programs:

either:
-a exit,always -F arch=&lt;ARCH&gt; -S ftruncate -F success=0

or both:
-a exit,always -F arch=&lt;ARCH&gt; -S ftruncate -F exit=-EPERM
-a exit,always -F arch=&lt;ARCH&gt; -S ftruncate -F exit=-EACCES

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29240</td>
<td>CCI-000126</td>
<td>medium</td>
<td>The audit system must be configured to audit file deletions.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>Edit the audit.rules file and add the following line to enable auditing of deletions:
-a exit,always -S rmdir 

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29241</td>
<td>CCE-14051-7</td>
<td>medium</td>
<td>The audit system must be configured to audit all administrative, privileged, and security actions.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;"restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;"restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.
Procedure:
Add the following lines to the audit.rules file to enable auditing of administrative, privileged, and security actions:

-w /etc/audit.rules
-w /etc/audit/audit.rules

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29242</td>
<td>CCE-14051-7</td>
<td>medium</td>
<td>The audit system must be configured to audit all administrative, privileged, and security actions.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;"restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;"restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.
Procedure:
Add the following lines to the audit.rules file to enable auditing of administrative, privileged, and security actions:

-a exit,always -F arch=&lt;ARCH&gt; -S adjtime

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29243</td>
<td>CCE-14051-7</td>
<td>medium</td>
<td>The audit system must be configured to audit all administrative, privileged, and security actions.</td>
<td> If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;"restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;"restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.
Procedure:
Add the following lines to the audit.rules file to enable auditing of administrative, privileged, and security actions:

-a exit,always -F arch=&lt;ARCH&gt; -S settimeofday

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29244</td>
<td>CCE-14051-7</td>
<td>medium</td>
<td>The audit system must be configured to audit all administrative, privileged, and security actions.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;"restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;"restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.
Procedure:
Add the following lines to the audit.rules file to enable auditing of administrative, privileged, and security actions:

-a exit,always -F arch=&lt;ARCH&gt; -S stime

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29245</td>
<td>CCE-14051-7</td>
<td>medium</td>
<td>The audit system must be configured to audit all administrative, privileged, and security actions.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;"restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;"restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.
Procedure:
Add the following lines to the audit.rules file to enable auditing of administrative, privileged, and security actions:

-a exit,always -F arch=&lt;ARCH&gt; -S clock_settime

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29246</td>
<td>CCE-14051-7</td>
<td>medium</td>
<td>The audit system must be configured to audit all administrative, privileged, and security actions.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;"restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;"restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.
Procedure:
Add the following lines to the audit.rules file to enable auditing of administrative, privileged, and security actions:

-a exit,always -F arch=&lt;ARCH&gt; -S sethostname

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29247</td>
<td>CCE-14051-7</td>
<td>medium</td>
<td>The audit system must be configured to audit all administrative, privileged, and security actions.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;"restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;"restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.
Procedure:
Add the following lines to the audit.rules file to enable auditing of administrative, privileged, and security actions:

-a exit,always -F arch=&lt;ARCH&gt; -S setdomainname

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29248</td>
<td>CCE-14051-7</td>
<td>medium</td>
<td>The audit system must be configured to audit all administrative, privileged, and security actions.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;"restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;"restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.
Procedure:
A Real Time Operating System (RTOS) provides specialized system scheduling which causes an inordinate number of messages to be produced when the sched_setparam and set_setscheduler are audited. This not only may degrade the system speed to an unusable level but obscures any forensic information which may otherwise have been useful.
Unless the operating system is a Red Hat 5 based RTOS (including MRG and AS5300) the following should also be present in /etc/audit/audit.rules

-a exit,always -F arch=&lt;ARCH&gt; -S sched_setparam

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29249</td>
<td>CCE-14051-7</td>
<td>medium</td>
<td>The audit system must be configured to audit all administrative, privileged, and security actions.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;"restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;"restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.
Procedure:
A Real Time Operating System (RTOS) provides specialized system scheduling which causes an inordinate number of messages to be produced when the sched_setparam and set_setscheduler are audited. This not only may degrade the system speed to an unusable level but obscures any forensic information which may otherwise have been useful.
Unless the operating system is a Red Hat 5 based RTOS (including MRG and AS5300) the following should also be present in /etc/audit/audit.rules

-a exit,always -F arch=&lt;ARCH&gt; -S sched_setscheduler

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29250</td>
<td>CCE-14058-2</td>
<td>medium</td>
<td>The audit system must be configured to audit all discretionary access control permission modifications.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.

Procedure:
Edit the audit.rules file and add the following lines to enable auditing of discretionary access control permissions modifications.
-a exit,always -F arch=&lt;ARCH&gt; -S fchmod

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29251</td>
<td>CCE-14058-2</td>
<td>medium</td>
<td>The audit system must be configured to audit all discretionary access control permission modifications.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.

Procedure:
Edit the audit.rules file and add the following lines to enable auditing of discretionary access control permissions modifications.
-a exit,always -F arch=&lt;ARCH&gt; -S fchmodat

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29252</td>
<td>CCE-14058-2</td>
<td>medium</td>
<td>The audit system must be configured to audit all discretionary access control permission modifications.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.

Procedure:
Edit the audit.rules file and add the following lines to enable auditing of discretionary access control permissions modifications.
-a exit,always -F arch=&lt;ARCH&gt; -S chown

Additionally, the following rule is required in systems supporting the 32-bit syscall table (such as i686 and x86_64):
-a exit,always -F arch=&lt;ARCH&gt; -S chown32

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29253</td>
<td>CCE-14058-2</td>
<td>medium</td>
<td>The audit system must be configured to audit all discretionary access control permission modifications.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.

Procedure:
Edit the audit.rules file and add the following lines to enable auditing of discretionary access control permissions modifications.
-a exit,always -F arch=&lt;ARCH&gt; -S fchown

Additionally, the following rule is required in systems supporting the 32-bit syscall table (such as i686 and x86_64):
-a exit,always -F arch=&lt;ARCH&gt; -S fchown32

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29255</td>
<td>CCE-14058-2</td>
<td>medium</td>
<td>The audit system must be configured to audit all discretionary access control permission modifications.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.

Procedure:
Edit the audit.rules file and add the following lines to enable auditing of discretionary access control permissions modifications.
-a exit,always -F arch=&lt;ARCH&gt; -S fchownat

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29257</td>
<td>CCE-14058-2</td>
<td>medium</td>
<td>The audit system must be configured to audit all discretionary access control permission modifications.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.

Procedure:
Edit the audit.rules file and add the following lines to enable auditing of discretionary access control permissions modifications.
-a exit,always -F arch=&lt;ARCH&gt; -S lchown

Additionally, the following rule is required in systems supporting the 32-bit syscall table (such as i686 and x86_64):
-a exit,always -F arch=&lt;ARCH&gt; -S lchown32


Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29259</td>
<td>CCE-14058-2</td>
<td>medium</td>
<td>The audit system must be configured to audit all discretionary access control permission modifications.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.

Procedure:
Edit the audit.rules file and add the following lines to enable auditing of discretionary access control permissions modifications.
-a exit,always -F arch=&lt;ARCH&gt; -S setxattr

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29261</td>
<td>CCE-14058-2</td>
<td>medium</td>
<td>The audit system must be configured to audit all discretionary access control permission modifications.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.

Procedure:
Edit the audit.rules file and add the following lines to enable auditing of discretionary access control permissions modifications.
-a exit,always -F arch=&lt;ARCH&gt; -S lsetxattr

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29272</td>
<td>CCE-14058-2</td>
<td>medium</td>
<td>The audit system must be configured to audit all discretionary access control permission modifications.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.

Procedure:
Edit the audit.rules file and add the following lines to enable auditing of discretionary access control permissions modifications.
-a exit,always -F arch=&lt;ARCH&gt; -S fsetxattr

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29274</td>
<td>CCE-14058-2</td>
<td>medium</td>
<td>The audit system must be configured to audit all discretionary access control permission modifications.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.

Procedure:
Edit the audit.rules file and add the following lines to enable auditing of discretionary access control permissions modifications.
-a exit,always -F arch=&lt;ARCH&gt; -S removexattr

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29275</td>
<td>CCE-14058-2</td>
<td>medium</td>
<td>The audit system must be configured to audit all discretionary access control permission modifications.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.

Procedure:
Edit the audit.rules file and add the following lines to enable auditing of discretionary access control permissions modifications.
-a exit,always -F arch=&lt;ARCH&gt; -S lremovexattr

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29279</td>
<td>CCE-14058-2</td>
<td>medium</td>
<td>The audit system must be configured to audit all discretionary access control permission modifications.</td>
<td>If the system is not configured to audit certain activities and write them to an audit log, it is more difficult to detect and track system compromises and damages incurred during a system compromise.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.

Procedure:
Edit the audit.rules file and add the following lines to enable auditing of discretionary access control permissions modifications.
-a exit,always -F arch=&lt;ARCH&gt; -S fremovexattr

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29281</td>
<td>CCE-14688-6</td>
<td>medium</td>
<td>The audit system must be configured to audit the loading and unloading of dynamic kernel modules - delete_module.</td>
<td>Actions concerning dynamic kernel modules must be recorded as they are substantial events. Dynamic kernel modules can increase the attack surface of a system. A malicious kernel module can be used to substantially alter the functioning of a system, often with the purpose of hiding a compromise from the SA.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.
Procedure:
Configure auditing of the delete_module syscalls.
Add the following to the "etc/audit/audit.rules" or "etc/audit.rules" file:

-a exit,always -S delete_module

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29284</td>
<td>CCE-14688-6</td>
<td>medium</td>
<td>The audit system must be configured to audit the loading and unloading of dynamic kernel modules - /sbin/insmod.</td>
<td>Actions concerning dynamic kernel modules must be recorded as they are substantial events. Dynamic kernel modules can increase the attack surface of a system. A malicious kernel module can be used to substantially alter the functioning of a system, often with the purpose of hiding a compromise from the SA.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.
Procedure:

Configure auditing of the /sbin/insmod, files.
Add the following to the "etc/audit/audit.rules" or "etc/audit.rules" file:
-w /sbin/insmod -p x

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29286</td>
<td>CCE-14688-6</td>
<td>medium</td>
<td>The audit system must be configured to audit the loading and unloading of dynamic kernel modules -/sbin/modprobe.</td>
<td>Actions concerning dynamic kernel modules must be recorded as they are substantial events. Dynamic kernel modules can increase the attack surface of a system. A malicious kernel module can be used to substantially alter the functioning of a system, often with the purpose of hiding a compromise from the SA.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.
Procedure:
-w /sbin/modprobe -p x

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29288</td>
<td>CCE-14688-6</td>
<td>medium</td>
<td>The audit system must be configured to audit the loading and unloading of dynamic kernel modules - /sbin/rmmod</td>
<td>Actions concerning dynamic kernel modules must be recorded as they are substantial events. Dynamic kernel modules can increase the attack surface of a system. A malicious kernel module can be used to substantially alter the functioning of a system, often with the purpose of hiding a compromise from the SA.</td>
<td></td>
<td>The "-F arch=&lt;ARCH&gt;" restriction is required on dual-architecture systems (such as x86_64). On dual-architecture systems, two separate rules must exist - one for each architecture supported. Use the generic architectures "b32" and "b64" for specifying these rules.
On single architecture systems, the "-F arch=&lt;ARCH&gt;" restriction may be omitted, but if present must match either the architecture of the system or its corresponding generic architecture. The architecture of the system may be determined by running "uname -m". See the auditctl(8) manpage for additional details.
Any restrictions (such as with "-F") beyond those provided in the example rules are not in strict compliance with this requirement, and are a finding unless justified and documented appropriately.
The use of audit keys consistent with the provided example is encouraged to provide for uniform audit logs, however omitting the audit key or using an alternate audit key is not a finding.

Procedure:
Configure auditing of the /sbin/rmmod file.
Add the following to the "etc/audit/audit.rules" or "etc/audit.rules" file:

-w /sbin/rmmod -p x

Restart the auditd service.
# service auditd restart</td>
</tr>
<tr>
<td>V-29289</td>
<td>CCI-000225</td>
<td>medium</td>
<td>Files in cron script directories must have mode 0700 or less permissive.</td>
<td>To protect the integrity of scheduled system jobs and prevent malicious modification to these jobs, crontab files must be secured.</td>
<td></td>
<td>Change the mode of the cron scripts.
# chmod 0700 /etc/cron.daily/* /etc/cron.hourly/* /etc/cron.monthly/* /etc/cron.weekly/*</td>
</tr>
<tr>
<td>V-766</td>
<td>CCE-3410-8</td>
<td>medium</td>
<td>The system must disable accounts after three consecutive unsuccessful login attempts.</td>
<td>Disabling accounts after a limited number of unsuccessful login attempts improves protection against password guessing attacks.</td>
<td></td>
<td>By default link /etc/pam.d/system-auth points to /etc/pam.d/system-auth-ac which is the file maintained by the authconfig utility. In order to add pam options other than those available via the utility create /etc/pam.d/system-auth-local with the options and including system-auth-ac. In order to set the account lockout to three failed attempts the content should be similar to:

auth required pam_access.so
auth required pam_tally2.so deny=3
auth include system-auth-ac
account required pam_tally2.so
account include system-auth-ac
password include system-auth-ac
session include system-auth-ac

Once system-auth-local is written reset the /etc/pam.d/system-auth to point to system-auth-local. This is necessary because authconfig writes directly to system-auth-ac so any changes made by hand will be lost if authconfig is run.</td>
</tr>
<tr>
<td>V-778</td>
<td>CCI-000770</td>
<td>medium</td>
<td>The system must prevent the root account from directly logging in except from the system console.</td>
<td>Limiting the root account direct logins to only system consoles protects the root account from direct unauthorized access from a non-console device.</td>
<td></td>
<td>Create if needed and set the contents of /etc/securetty to a "console" or "tty" device.
# echo console &gt; /etc/securetty
or
# echo tty1 &gt; /etc/securetty</td>
</tr>
<tr>
<td>V-811</td>
<td>CCE-4292-9</td>
<td>medium</td>
<td>Auditing must be implemented.</td>
<td>Without auditing, individual system accesses cannot be tracked and malicious activity cannot be detected and traced back to an individual account.</td>
<td></td>
<td>Start the auditd service and set it to start on boot.
# service auditd start ; chkconfig auditd on</td>
</tr>
</table>
</body>
</html>
